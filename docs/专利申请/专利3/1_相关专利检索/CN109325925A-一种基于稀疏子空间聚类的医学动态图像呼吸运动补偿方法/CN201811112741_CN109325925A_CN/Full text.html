<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1"><business:ClaimText>1.一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，其特征在于，包括如下步骤：</business:ClaimText></td></tr><tr><td class="content" id="claim_2"><business:ClaimText>步骤S1，采集医学动态图像，确定预处理方法，以减少图像噪声对补偿效果的影响；</business:ClaimText></td></tr><tr><td class="content" id="claim_3"><business:ClaimText>步骤S2，选择稀疏子空间表示方法，并确定所述稀疏子空间表示方法相对应的惩罚项约束方法；</business:ClaimText></td></tr><tr><td class="content" id="claim_4"><business:ClaimText>步骤S3，根据所述步骤S2选定的稀疏子空间表示方法和所确定的惩罚项约束方法，求解得到所述医学动态图像的稀疏子空间表示系数矩阵，所述稀疏子空间表示系数矩阵用于表示医学动态图像中帧与帧之间的关系；</business:ClaimText></td></tr><tr><td class="content" id="claim_5"><business:ClaimText>步骤S4，根据所述步骤S3得到的稀疏子空间表示系数矩阵进行处理，构造相似度度量矩阵；</business:ClaimText></td></tr><tr><td class="content" id="claim_6"><business:ClaimText>步骤S5，根据所述步骤S4得到的相似度度量矩阵，采用谱聚类方法获得医学动态图像的聚类结果；</business:ClaimText></td></tr><tr><td class="content" id="claim_7"><business:ClaimText>步骤S6，根据所述步骤S5得到医学动态图像的聚类结果，选择最终呼吸运动补偿图像。</business:ClaimText></td></tr><tr><td class="content" id="claim_8"><business:ClaimText>2.根据权利要求1所述的基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，其特征在于，所述步骤(1)中，对动态图像的预处理操作主要是对医学动态图像进行降噪处理。</business:ClaimText></td></tr><tr><td class="content" id="claim_9"><business:ClaimText>3.根据权利要求1所述的基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，其特征在于，所述步骤(2)中所述的稀疏子空间表示方法为稀疏表示或低秩表示或岭回归表示。</business:ClaimText></td></tr><tr><td class="content" id="claim_10"><business:ClaimText>4.根据权利要求1所述的基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，其特征在于，所述步骤(2)中以惩罚项约束的方式求解得到所述医学动态图像的稀疏子空间表示系数矩阵，所述稀疏子空间表示系数矩阵表示了医学动态图像中帧与帧之间的关系。</business:ClaimText></td></tr><tr><td class="content" id="claim_11"><business:ClaimText>5.根据权利要求1所述的基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，其特征在于，所述步骤(5)中，利用归一化切方法对所述相似度度量矩阵进行切割，该算法根据需要聚类的数目，将所述相似度度量矩阵所对应的医学动态图像切割成不同的聚类。</business:ClaimText></td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table style="table-layout:fixed"><tr><td id="description_title" class="header">
						说明书
					</td></tr><tr><td class="content" id="description_invention_title">一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法</td></tr><tr><td class="content" id="description_1">技术领域</td></tr><tr><td class="content" id="description_2">本发明涉及一种属于计算机技术与医学图像处理的交叉领域，具体涉及一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法。</td></tr><tr><td class="content" id="description_3">背景技术</td></tr><tr><td class="content" id="description_4">医学动态图像为时间序列图像，提供了观测目标生理或病理的重要诊断信息，通过实时观察观测目标不同时相的动态图像表现，可对疾病、状态或生理过程进行鉴别，特别是对良、恶性肿瘤的诊断具有很高敏感性和特异性。目前，医学动态成像方法主要有超声造影(Contrast-Enhanced UltraSound，CEUS)、增强CT(Computed Tomography，CT)、增强MRI(Magnetic Resonance Imaging，MRI)等。然而，在进行胸、腹部医学动态图像检查过程中，随着人体的呼吸，胸腹部器官的形状、位置会发生明显的变化，致使获得的动态序列图像帧与帧之间观察目标来回运动、形变，不利于动态图像的观察与诊断。</td></tr><tr><td class="content" id="description_5">为减少呼吸带来的不利影响，现有的呼吸运动补偿方法主要有图像配准方法和呼吸门控方法。图像配准方法是在动态序列图像中，人工选择其中一帧图像为参考图像，采用图像配准算法将其余帧图像逐帧与参考图像进行配准，该方法需人工干预，易受主观因素影响。呼吸门控方法则首先提取可反映呼吸运动的周期性幅度呼吸信号，然后根据呼吸信号的幅度将每个呼吸周期(一次呼气和一次吸气为一个周期)分成若干个呼吸位置，最后设计某种门控策略选择某一呼吸位置的子序列图像作为最终补偿图像。该方法需提取准确的呼吸信号和人工选择呼吸补偿位置，然而不同患者呼吸的幅度、周期等均有很大的差别，且在医学动态图像检查过程中，除了呼吸运动成分之外，还存在诸如心脏搏动等其它运动成分，复杂多样的运动成分为呼吸信号的准确提取及呼吸补偿位置的选择带来了极大困难。</td></tr><tr><td class="content" id="description_6">综上所述，现有呼吸运动补偿方法用于医学动态图像时，存在需要人工参与、易受主观因素影响等问题。</td></tr><tr><td class="content" id="description_7">发明内容</td></tr><tr><td class="content" id="description_8">为了解决上述技术问题，本发明提供了一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，应用此方法时仅需将待补偿的医学动态图像数据作为输入，即可输出经呼吸运动补偿后的序列图像，以供进一步的临床医生诊断应用。此方法具有实施方便、无需人工干预的优点，可减少呼吸带来的不利影响，提高呼吸运动补偿的有效性。</td></tr><tr><td class="content" id="description_9">本发明采用如下技术方案：一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法，包括如下步骤：</td></tr><tr><td class="content" id="description_10">步骤S1，采集医学动态图像，对动态图像进行预处理；</td></tr><tr><td class="content" id="description_11">该步骤中，对动态图像的预处理操作主要是对医学动态图像进行降噪处理。例如，采用斑点噪声各向异性扩散算法(Speckle Reducing Anisotropic Diffusion,SRAD)对超声造影图像进行图像降噪，采用非局部均值算法(Non-Local Means,NLM)对增强CT动态图像或增强MRI动态图像进行图像降噪。</td></tr><tr><td class="content" id="description_12">步骤S2，选择稀疏子空间表示方法，并确定所述稀疏子空间表示方法相对应的惩罚项约束方法；</td></tr><tr><td class="content" id="description_13">该步骤中，常用的稀疏子空间表示方法可以是稀疏表示，低秩表示和岭回归表示，其对应的惩罚项约束分别为l1范数约束，核范数约束和F范数约束。以Z表示步骤S3中的稀疏子空间表示系数矩阵，则惩罚项约束写为f(Z)，其对应的稀疏表示系数矩阵的约束依次为‖Z‖<base:Sub>1</base:Sub>，‖Z‖<base:Sub>*</base:Sub>和‖Z‖<base:Sub>F</base:Sub>，通过对惩罚项进行约束，可使得稀疏表示矩阵满足不同的特性，以表达数据本身的相关信息。如增加核范数约束，可挖掘数据空间的结构信息。在选择时一般以数据表达的信息及计算的复杂程度为依据。为充分利用动态图像空间结构信息和时间序列信息，在选择岭回归表示，对惩罚项进行F范数约束的基础上，再增加拉普拉斯正则项<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555430&amp;blobId=3557262919" width="141"/>约束；</td></tr><tr><td class="content" id="description_14">所述拉普拉斯正则项约束表示为：</td></tr><tr><td class="content" id="description_15"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555428&amp;blobId=3557227439" width="492"/></td></tr><tr><td class="content" id="description_16">其中，z<base:Sub>i</base:Sub>为第i帧图像对应的表示系数，z<base:Sub>j</base:Sub>为第j帧图像对应的表示系数，n为动态图像总帧数，w为权值系数，其表达式为：</td></tr><tr><td class="content" id="description_17"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555424&amp;blobId=3557082938" width="492"/></td></tr><tr><td class="content" id="description_18">其中，d为邻域大小系数，用于调节邻域的大小。</td></tr><tr><td class="content" id="description_19">步骤S3，根据所述步骤S2选定的稀疏子空间表示方法和确定的惩罚项约束方法，基于一优化目标函数，求解得到所述医学动态图像的稀疏子空间表示系数矩阵，所述稀疏子空间表示系数矩阵用于表示医学动态图像中帧与帧之间的关系；</td></tr><tr><td class="content" id="description_20">所述优化目标函数表示为：</td></tr><tr><td class="content" id="description_21"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555408&amp;blobId=3557321716" width="492"/></td></tr><tr><td class="content" id="description_22">其中，α和β为预设的平衡参数，用于控制惩罚项的比例。</td></tr><tr><td class="content" id="description_23">所述步骤S3进一步采用交替方向乘子法(Alternating Direction Method ofMultipliers,ADMM)求解所述优化目标函数，得到所述医学动态图像的稀疏子空间表示系数矩阵Z。</td></tr><tr><td class="content" id="description_24">步骤S4，根据所述步骤S3得到的稀疏系数矩阵Z，构造相似度度量矩阵G；所述相似度度量矩阵G构造方式为：</td></tr><tr><td class="content" id="description_25"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555404&amp;blobId=3557038344" width="492"/></td></tr><tr><td class="content" id="description_26">步骤S5，根据所述步骤S4构造的相似度度量矩阵G，利用谱聚类方法对所述的相似度度量矩阵G进行切割，得到所述医学动态图像的聚类结果；</td></tr><tr><td class="content" id="description_27">该步骤中，利用现有技术中常用的归一化切方法对所述相似度度量矩阵进行切割，该算法根据需要聚类的数目，将所述相似度度量矩阵所对应的医学动态图像切割成不同的聚类。</td></tr><tr><td class="content" id="description_28">步骤S6，根据所述步骤S5得到的聚类结果，选择最大类图像为呼吸运动补偿图像；所述最大类图像为所述聚类结果中图像数量最多的图像类。</td></tr><tr><td class="content" id="description_29">本发明提出的上述方法能够广泛的应用于医学动态图像的呼吸运动补偿问题。在该方法中，首先对医学动态图像进行预处理，以减少图像噪声对补偿效果的影响；然后充分利用动态图像空间结构信息和时间序列信息，以惩罚项约束的方式求解得到所述医学动态图像的稀疏子空间表示系数矩阵，所述稀疏子空间表示系数矩阵表示了医学动态图像中帧与帧之间的关系；接着根据疏子空间表示系数矩阵构造相似度度量矩阵；再利用谱聚类方法获得医学动态图像的聚类结果；最后，将最大图像类结果作为最终呼吸运动补偿图像。</td></tr><tr><td class="content" id="description_30">本发明具有的优点：1、提供了一种基于稀疏子空间聚类的医学动态图像呼吸运动补偿方法；</td></tr><tr><td class="content" id="description_31">2、此方法实施方便、无需人工干预；</td></tr><tr><td class="content" id="description_32">3、此方法仅需将待补偿的医学动态图像数据作为输入，即可输出经呼吸运动补偿后的序列图像，提高了呼吸运动补偿的有效性，减少呼吸带来的不利影响，补偿后的序列图像可供进一步的临床医生诊断应用。</td></tr><tr><td class="content" id="description_33">附图说明</td></tr><tr><td class="content" id="description_34">图1是本发明基于稀疏子空间聚类的医学动态增强图像呼吸运动补偿方法的流程图。</td></tr><tr><td class="content" id="description_35">图2是未进行呼吸运动补偿的超声造影图像。</td></tr><tr><td class="content" id="description_36">图3是本发明方法的超声造影图像呼吸运动补偿结果。</td></tr><tr><td class="content" id="description_37">具体实施方式</td></tr><tr><td class="content" id="description_38">下面结合附图对本发明的优选实施例进行详细阐述，以使本发明的优点和特征能更易于被本领域技术人员理解，从而对本发明的保护范围做出更为清楚明确的界定。</td></tr><tr><td class="content" id="description_39">如图1所示，本发明基于稀疏子空间聚类的医学动态增强图像呼吸运动补偿方法包括以下步骤：</td></tr><tr><td class="content" id="description_40">步骤S1，采集超声造影动态图像，对动态图像进行预处理；</td></tr><tr><td class="content" id="description_41">该步骤中，对动态图像的预处理操作主要是对医学动态图像进行降噪处理。采用斑点噪声各向异性扩散算法(Speckle Reducing Anisotropic Diffusion,SRAD)对超声造影图像进行图像降噪。</td></tr><tr><td class="content" id="description_42">步骤S2，选择稀疏子空间表示方法，并确定所述稀疏子空间表示方法相对应的惩罚项约束方法；</td></tr><tr><td class="content" id="description_43">该步骤中，常用的稀疏子空间表示方法可以是稀疏表示，低秩表示和岭回归表示，其对应的惩罚项约束分别为l1范数约束，核范数约束和F范数约束。以Z表示步骤S3中的稀疏子空间表示系数矩阵，则惩罚项约束写为f(Z)，其对应的稀疏表示系数矩阵的约束依次为‖Z‖<base:Sub>1</base:Sub>，‖Z‖<base:Sub>*</base:Sub>和‖Z‖<base:Sub>F</base:Sub>，通过对惩罚项进行约束，可使得稀疏表示矩阵满足不同的特性，以表达数据本身的相关信息。如增加核范数约束，可挖掘数据空间的结构信息。在选择时一般以数据表达的信息及计算的复杂程度为依据。在本实例中，为充分利用动态图像空间结构信息和时间序列信息，在选择岭回归表示，对惩罚项进行F范数约束的基础上，再增加拉普拉斯正则项<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555420&amp;blobId=3557190738" width="95"/>约束；</td></tr><tr><td class="content" id="description_44">所述拉普拉斯正则项约束表示为：</td></tr><tr><td class="content" id="description_45"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555426&amp;blobId=3557149697" width="492"/></td></tr><tr><td class="content" id="description_46">其中，z<base:Sub>i</base:Sub>为第i帧图像对应的表示系数，z<base:Sub>j</base:Sub>为第j帧图像对应的表示系数，n为动态图像总帧数，w为权值系数，其表达式为：</td></tr><tr><td class="content" id="description_47"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555416&amp;blobId=3557255624" width="492"/></td></tr><tr><td class="content" id="description_48">其中，d为邻域大小系数，用于调节邻域的大小。本实例中邻域大小系数取值为2，所述权值系数矩阵则为：</td></tr><tr><td class="content" id="description_49"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555412&amp;blobId=3557322732" width="492"/></td></tr><tr><td class="content" id="description_50">步骤S3，根据所述步骤S2选定的稀疏子空间表示方法和确定的惩罚项约束方法，基于一优化目标函数，求解得到所述医学动态图像的稀疏子空间表示系数矩阵，所述稀疏子空间表示系数矩阵用于表示医学动态图像中帧与帧之间的关系；</td></tr><tr><td class="content" id="description_51">所述优化目标函数表示为：</td></tr><tr><td class="content" id="description_52"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555399&amp;blobId=3557295674" width="492"/></td></tr><tr><td class="content" id="description_53">其中，α和β为预设的平衡参数，用于控制惩罚项的比例。本实例中α和β取值分别为0.01和15。</td></tr><tr><td class="content" id="description_54">所述步骤S3进一步采用交替方向乘子法(Alternating Direction Method ofMultipliers,ADMM)求解所述优化目标函数，得到所述医学动态图像的稀疏子空间表示系数矩阵Z。</td></tr><tr><td class="content" id="description_55">步骤S4，根据所述步骤S3得到的稀疏系数矩阵Z，构造相似度度量矩阵G；</td></tr><tr><td class="content" id="description_56">所述相似度度量矩阵G构造方式为：</td></tr><tr><td class="content" id="description_57"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4253555395&amp;blobId=3557145693" width="492"/></td></tr><tr><td class="content" id="description_58">步骤S5，根据所述步骤S4构造的相似度度量矩阵G，利用谱聚类方法对所述的相似度度量矩阵G进行切割，得到所述医学动态图像的聚类结果；</td></tr><tr><td class="content" id="description_59">该步骤中，利用现有技术中常用的归一化切方法对所述相似度度量矩阵进行切割，该算法根据需要聚类的数目，将所述相似度度量矩阵所对应的医学动态图像切割成不同的聚类。本实例中，聚类数目设定为20。</td></tr><tr><td class="content" id="description_60">步骤S6，根据所述步骤S5得到的聚类结果，选择最大类图像为呼吸运动补偿图像；所述最大类图像为所述聚类结果中图像数量最多的图像类。本实例中，医学超声造影图像的补偿前后结果对比如图2、图3所示。</td></tr><tr><td class="content" id="description_61">不局限于此，任何不经过创造性劳动想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求书所限定的保护范围为准。</td></tr></table></div></body></html>
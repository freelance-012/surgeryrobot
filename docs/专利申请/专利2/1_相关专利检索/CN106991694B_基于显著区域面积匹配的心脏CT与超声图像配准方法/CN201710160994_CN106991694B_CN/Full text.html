<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1"><business:ClaimText>1.基于显著区域面积匹配的心脏CT与超声图像配准方法，包括如下步骤：</business:ClaimText></td></tr><tr><td class="content" id="claim_2"><business:ClaimText>(1)输入待配准心脏CT图像及食道超声心动图TEE，采用双线性插值方法调整CT图像，使其与TEE图像像素大小一致；</business:ClaimText></td></tr><tr><td class="content" id="claim_3"><business:ClaimText>(2)对CT图像和TEE图像分别进行非局部均值滤波处理，并将滤波后的CT图像作为参考图像r，将滤波后的TEE图像作为浮动图像f；</business:ClaimText></td></tr><tr><td class="content" id="claim_4"><business:ClaimText>(3)分别建立参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>、邻域均差特征金字塔模型A<base:Sub>M</base:Sub>和和浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>、邻域均差特征金字塔模型B<base:Sub>M</base:Sub>：</business:ClaimText></td></tr><tr><td class="content" id="claim_5"><business:ClaimText>(3a)提取参考图像r的灰度特征图I<base:Sub>r</base:Sub>和邻域均差特征图M<base:Sub>r</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_6"><business:ClaimText>(3b)以灰度特征图I<base:Sub>r</base:Sub>为第一层，在其基础上进行下采样，得到大小为第一层图像1/2的第二层灰度特征图，再在第二层灰度特征图上进行相同下采样，得到大小为第二层灰度特征图1/2的第三层灰度特征图，以此三层灰度特征图建立参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_7"><business:ClaimText>(3c)按照与(3b)相同的操作建立参考图像r的邻域均差特征金字塔模型A<base:Sub>M</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_8"><business:ClaimText>(3d)提取浮动图像f的灰度特征图I<base:Sub>f</base:Sub>和邻域均差特征图M<base:Sub>f</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_9"><business:ClaimText>(3e)按照与(3b)相同的操作建立浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>和邻域均差特征金字塔模型B<base:Sub>M</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_10"><business:ClaimText>(4)根据参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>和邻域均差特征金字塔模型A<base:Sub>M</base:Sub>生成参考图像的显著图S<base:Sub>r</base:Sub>，根据浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>和邻域均差特征金字塔模型B<base:Sub>M</base:Sub>生成浮动图像的显著图S<base:Sub>f</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_11"><business:ClaimText>(5)设置灰度阈值T<base:Sub>1</base:Sub>＝85，利用灰度阈值T<base:Sub>1</base:Sub>分别对参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>进行二值化分割，得到参考图像显著图的分割结果b<base:Sub>r</base:Sub>和浮动图像显著图的分割结果b<base:Sub>f</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_12"><business:ClaimText>(6)分别统计参考图像显著图的分割结果b<base:Sub>r</base:Sub>和浮动图像显著图的分割结果b<base:Sub>f</base:Sub>中各非连通区域的面积，根据非连通区域的面积特征提取参考图像的感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和浮动图像的感兴趣区域轮廓点集p<base:Sub>f</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_13"><business:ClaimText>(7)分别提取参考图像r中感兴趣区域的质心(x<base:Sub>r</base:Sub>,y<base:Sub>r</base:Sub>)和浮动图像f中感兴趣区域的质心(x<base:Sub>f</base:Sub>,y<base:Sub>f</base:Sub>)，计算两区域质心间的距离(Δx,Δy)，并将浮动图像f和其感兴趣区域轮廓点集p<base:Sub>f</base:Sub>分别横向平移Δx个像素，纵向平移Δy个像素，得到粗配准结果图f'和粗配准结果图的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_14"><business:ClaimText>(8)以参考图像r的感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和粗配准结果图f'的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>作为输入，使用迭代最近点ICP算法进行精配准，得到两点集之间的旋转矩阵TR和平移矩阵TT；</business:ClaimText></td></tr><tr><td class="content" id="claim_15"><business:ClaimText>(9)将粗配准结果图f'按旋转矩阵TR和平移矩阵TT依次进行旋转和平移操作，得到最终配准结果q，完成配准工作。</business:ClaimText></td></tr><tr><td class="content" id="claim_16"><business:ClaimText>2.根据权利要求1所述的方法，其中步骤(3a)中提取参考图像r的灰度特征图I<base:Sub>r</base:Sub>和邻域均差特征图M<base:Sub>r</base:Sub>，通过如下公式进行：</business:ClaimText></td></tr><tr><td class="content" id="claim_17"><business:ClaimText><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4427510151&amp;blobId=3678152836" width="492"/></business:ClaimText></td></tr><tr><td class="content" id="claim_18"><business:ClaimText>M<base:Sub>r</base:Sub>(i,j)＝|r(i,j)-F(i,j)|</business:ClaimText></td></tr><tr><td class="content" id="claim_19"><business:ClaimText>式中I<base:Sub>r</base:Sub>(i,j)是参考图像r的灰度特征图I<base:Sub>r</base:Sub>在坐标(i,j)处的值，r(i,j)是参考图像r在坐标(i,j)处的灰度值，max()为提取矩阵最大灰度值，min()为提取矩阵最小灰度值，M<base:Sub>r</base:Sub>是邻域均差特征图，M<base:Sub>r</base:Sub>(i,j)是M<base:Sub>r</base:Sub>在坐标(i,j)处的值，F(i,j)是参考图像r在坐标(i,j)处的3×3邻域均值。</business:ClaimText></td></tr><tr><td class="content" id="claim_20"><business:ClaimText>3.根据权利要求1所述方法，其中步骤(4)中生成参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>，按如下步骤进行：</business:ClaimText></td></tr><tr><td class="content" id="claim_21"><business:ClaimText>(4a)将参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中的第一层图像分别与δ<base:Sub>1</base:Sub>＝32和δ<base:Sub>2</base:Sub>＝64的两个高斯核进行二维卷积，用该层图像减去卷积后图像，再对两个差分结果图求和并归一化得到第一层图像显著图；</business:ClaimText></td></tr><tr><td class="content" id="claim_22"><business:ClaimText>(4b)采用(4a)相同的操作得到参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中第二、第三层图像显著图；</business:ClaimText></td></tr><tr><td class="content" id="claim_23"><business:ClaimText>(4c)对参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中三层显著图求平均，得到参考图像r的灰度特征显著图S<base:Sub>rI</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_24"><business:ClaimText>(4d)对参考图像r邻域均差特征金字塔模型A<base:Sub>M</base:Sub>采用(4a)-(4c)相同操作，得到参考图像r的邻域均差特征显著图S<base:Sub>rM</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_25"><business:ClaimText>(4e)对参考图像r的灰度特征显著图S<base:Sub>rI</base:Sub>和邻域均差特征显著图S<base:Sub>rM</base:Sub>求和，得到参考图像r的最终显著图S<base:Sub>r</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_26"><business:ClaimText>(4f)对浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>和邻域均差特征金字塔模型B<base:Sub>M</base:Sub>采用(4a)-(4e)相同操作，得到浮动图像f的最终显著图S<base:Sub>f</base:Sub>。</business:ClaimText></td></tr><tr><td class="content" id="claim_27"><business:ClaimText>4.根据权利要求1所述方法，其中步骤(6)中提取参考图像r和浮动图像f感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和p<base:Sub>f</base:Sub>，按如下步骤进行：</business:ClaimText></td></tr><tr><td class="content" id="claim_28"><business:ClaimText>(6a)统计参考图像最终显著图的分割结果b<base:Sub>r</base:Sub>中各非连通区域的面积，根据面积大小对各连通区域按降序排序；</business:ClaimText></td></tr><tr><td class="content" id="claim_29"><business:ClaimText>(6b)按(6a)中排序顺序，从第二个非连通区域开始计算各区域与其前一区域面积的比值，并将该比值与设定的面积比阈值T<base:Sub>2</base:Sub>＝0.25进行比较，若该比值大于T<base:Sub>2</base:Sub>，则标记该区域为感兴趣区域，并继续判断下一区域是否为感兴趣区域，否则，提取所有在迭代过程中标记为感兴趣区域的区域轮廓点，作为参考图像r的感兴趣区域的轮廓点集p<base:Sub>r</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_30"><business:ClaimText>(6c)按(6a)-(6b)的相同操作，提取浮动图像f的感兴趣区域的轮廓点集p<base:Sub>f</base:Sub>。</business:ClaimText></td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table style="table-layout:fixed"><tr><td id="description_title" class="header">
						说明书
					</td></tr><tr><td class="content" id="description_invention_title">基于显著区域面积匹配的心脏CT与超声图像配准方法</td></tr><tr><td class="content" id="description_1">技术领域</td></tr><tr><td class="content" id="description_2">本发明属于医学图像处理技术领域，特别是一种图像的配准方法，可用于心脏手术中对术前CT图像和术中超声图像的实时配准。</td></tr><tr><td class="content" id="description_3">背景技术</td></tr><tr><td class="content" id="description_4">随着现代社会生活节奏的不断加快、生活压力的不断增大，心血管疾病的发病率逐年攀升。据世界卫生组织的调查数据显示，每年心血管疾病的死亡人数占全球死亡总数的30％。预计到2030年，死于心血管疾病的人数将增加至2330万，心血管疾病将继续成为威胁人类健康的头号死因。因此对心血管疾病的诊断研究受到广泛关注，更加准确、高效的医疗诊断成为一种迫切的需要。</td></tr><tr><td class="content" id="description_5">目前，对于心脏的诊疗和评估高度依赖于CT、超声和核磁共振等成像技术。其中，心脏超声成像由于成本相对较低、能够实时成像和操作方便等原因，被广泛应用于微创手术中。它可以帮助医生在手术过程中定位病理区域，并为手术工具提供引导。而超声图像固有的斑点噪声、伪影、分辨率差、信噪比较低等局限，使得它难以清晰的显示器官、血管和肿瘤的解剖结构和病理信息。CT图像虽然成像精度和信噪比高，但由于成本高、灵活性差、不能实时成像等缺点，无法反映手术中组织的移位和变形。</td></tr><tr><td class="content" id="description_6">将术前CT图像与术中超声图像两种模态图像信息相结合，利用术前图像的信息来引导术中图像，提高手术的精度和准确率，是当前研究的热点。其中术前CT图像和术中超声图像配准技术是图像引导手术中的关键技术。</td></tr><tr><td class="content" id="description_7">超声图像与CT图像的配准方法，目前主要包括基于灰度的方法和基于几何或解剖特征的方法。基于灰度的配准方法直接利用整幅图像的灰度信息，建立两幅图像之间的相似性度量，然后使用搜索方法寻找使相似性度量值最大或最小的变化模型的参数值。然而，由于超声图像质量较差、与CT图像灰度差异大，单一的基于灰度的配准精度并不理想且耗时长，不能满足图像引导手术对图像配准精度和速度的要求。基于特征的配准方法将对整个图像的分析转换为对图像特征的分析，所说大大减少了图像处理过程中的计算量，具有较好的实时性，但配准精度的高低主要取决于几何或解剖特征的选择和提取，特征提取的准确程度将对整个配准过程产生很大的影响，由于常用的特征提取主要依赖于人工选取，速度慢且会引入人为偏差，使提取的不同模态下图像特征差异较大。因此迫切需要准确可靠、全自动的特征提取方法以确保图像配准的精度和速度，满足手术要求。</td></tr><tr><td class="content" id="description_8">发明内容</td></tr><tr><td class="content" id="description_9">本发明的目的在于针对目前已有配准技术的不足，提出一种基于显著区域面积匹配的心脏CT图像与超声图像配准方法，以实现CT图像对超声图像的精确引导，提高手术的精度和成功率。</td></tr><tr><td class="content" id="description_10">为实现上述目的，本发明包括如下步骤：</td></tr><tr><td class="content" id="description_11">(1)输入待配准心脏CT图像及食道超声心动图TEE，采用双线性插值方法调整CT图像，使其与TEE图像每个像素对应的物理分辨率大小一致；</td></tr><tr><td class="content" id="description_12">(2)对CT图像和TEE图像分别进行非局部均值滤波处理，并将滤波后的CT图像作为参考图像r，将滤波后的TEE图像作为浮动图像f；</td></tr><tr><td class="content" id="description_13">(3)分别建立参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>、邻域均差特征金字塔模型A<base:Sub>M</base:Sub>和浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>、邻域均差特征金字塔模型B<base:Sub>M</base:Sub>；</td></tr><tr><td class="content" id="description_14">(4)根据参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>和邻域均差特征金字塔模型A<base:Sub>M</base:Sub>生成参考图像的显著图S<base:Sub>r</base:Sub>，根据浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>和邻域均差特征金字塔模型B<base:Sub>M</base:Sub>生成浮动图像的显著图S<base:Sub>f</base:Sub>；</td></tr><tr><td class="content" id="description_15">(5)设置灰度阈值T<base:Sub>1</base:Sub>＝85，利用灰度阈值T<base:Sub>1</base:Sub>分别对参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>进行二值化分割，得到参考图像显著图的分割结果b<base:Sub>r</base:Sub>和浮动图像显著图的分割结果b<base:Sub>f</base:Sub>；</td></tr><tr><td class="content" id="description_16">(6)分别统计参考图像显著图的分割结果b<base:Sub>r</base:Sub>和浮动图像显著图的分割结果b<base:Sub>f</base:Sub>中每个非连通区域的面积，根据非连通区域的面积特征提取参考图像的感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和浮动图像的感兴趣区域轮廓点集p<base:Sub>f</base:Sub>；</td></tr><tr><td class="content" id="description_17">(7)分别提取参考图像r中感兴趣区域的质心(x<base:Sub>r</base:Sub>,y<base:Sub>r</base:Sub>)和浮动图像f中感兴趣区域的质心(x<base:Sub>f</base:Sub>,y<base:Sub>f</base:Sub>)，计算两区域质心间的距离(Δx,Δy)，并将浮动图像f和其感兴趣区域轮廓点集p<base:Sub>f</base:Sub>分别横向平移Δx个像素，纵向平移Δy个像素，得到粗配准结果图f'和粗配准结果图f'的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>；</td></tr><tr><td class="content" id="description_18">(8)以参考图像r的感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和粗配准结果图f'的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>作为输入，使用迭代最近点ICP算法进行精配准，得到两点集之间的旋转矩阵TR和平移矩阵TT；</td></tr><tr><td class="content" id="description_19">(9)将粗配准结果图f'按旋转矩阵TR和平移矩阵TT依次进行旋转和平移操作，得到最终配准结果q，输出配准图像q。</td></tr><tr><td class="content" id="description_20">本发明与现有技术相比具有以下优点：</td></tr><tr><td class="content" id="description_21">1、本发明通过分别建立参考图像和浮动图像的灰度特征金字塔模型和邻域均差特征金字塔模型以提取其显著图，并根据区域面积特征精确地提取了参考图像和浮动图像的感兴趣区域，为后续参考图像和浮动图像的高精度配准奠定了基础。</td></tr><tr><td class="content" id="description_22">2、本发明对参考图像和浮动图像进行了基于参考图像和浮动图像感兴趣区域质心距离的粗配准和基于迭代最近点ICP算法的精配准，具有更高的准确性。</td></tr><tr><td class="content" id="description_23">3、本发明在整个配准过程中实现了全自动化，无需人机交互，避免了人为因素的干扰，配准效率高，满足图像引导手术对配准速度和配准精度的要求。</td></tr><tr><td class="content" id="description_24">附图说明</td></tr><tr><td class="content" id="description_25">图1是本发明的实现流程图；</td></tr><tr><td class="content" id="description_26">图2是从某医院获取的心脏CT图像和心脏食道超声TEE图像；</td></tr><tr><td class="content" id="description_27">图3是用本发明提取CT图像和TEE图像的显著图；</td></tr><tr><td class="content" id="description_28">图4是用本发明对CT图像和TEE图像的显著图进行二值化后的结果图；</td></tr><tr><td class="content" id="description_29">图5是用本发明对CT图像和TEE图像感兴趣区域的分割结果图；</td></tr><tr><td class="content" id="description_30">图6是以CT图为参考图像，TEE图为浮动图像，采用本发明进行配准的结果图；</td></tr><tr><td class="content" id="description_31">图7是本发明所使用的同一个人的心脏CT图像和超声TEE图像；</td></tr><tr><td class="content" id="description_32">图8是用本发明对图7中CT图像和超声TEE图像进行配准的结果图。</td></tr><tr><td class="content" id="description_33">具体实施方法</td></tr><tr><td class="content" id="description_34">以下结合附图对本发明的实施例和效果作详细描述。</td></tr><tr><td class="content" id="description_35">参照图1，本发明的实现步骤如下：</td></tr><tr><td class="content" id="description_36">步骤1.输入心脏CT图像和食道超声TEE图像，调整图像像素大小。</td></tr><tr><td class="content" id="description_37">心脏CT图像和食道超声图像是从某医院获取的，如图2所示，其中图2(a)是心脏CT图像，图2(b)是食道超声TEE图像，心脏CT图像的大小是512×512，像素分辨率是0.24×0.24mm，食道超声TEE图像的大小是600×800，像素分辨率是0.17×0.17mm；</td></tr><tr><td class="content" id="description_38">采用双线性插值方法调整CT图像，使其与TEE图像像素分辨率大小一致。</td></tr><tr><td class="content" id="description_39">步骤2.对待配准图像进行预处理。</td></tr><tr><td class="content" id="description_40">将心脏CT图像进行非局部均值滤波，使图像更平滑、清晰，并用滤波后的图像作为参考图像r；</td></tr><tr><td class="content" id="description_41">将食道超声TEE图像进行非局部均值滤波，以去除其固有的斑点、伪影这些噪声，使图像更平滑、清晰，并用该滤波后的图像作为浮动图像f。</td></tr><tr><td class="content" id="description_42">步骤3.分别建立参考图像r和浮动图像f的灰度特征金字塔模型和邻域均差特征金字塔模型。</td></tr><tr><td class="content" id="description_43">(3a)提取参考图像r的灰度特征图I<base:Sub>r</base:Sub>和邻域均差特征图M<base:Sub>r</base:Sub>：</td></tr><tr><td class="content" id="description_44"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4427510140&amp;blobId=3677909707" width="492"/></td></tr><tr><td class="content" id="description_45">M<base:Sub>r</base:Sub>(i,j)＝|r(i,j)-F(i,j)|</td></tr><tr><td class="content" id="description_46">式中I<base:Sub>r</base:Sub>(i,j)是参考图像r的灰度特征图I<base:Sub>r</base:Sub>在坐标(i,j)处的值，r(i,j)是参考图像r在坐标(i,j)处的灰度值，max()为提取矩阵最大灰度值，min()为提取矩阵最小灰度值，M<base:Sub>r</base:Sub>是邻域均差特征图，M<base:Sub>r</base:Sub>(i,j)是M<base:Sub>r</base:Sub>在坐标(i,j)处的值，F(i,j)是参考图像r在坐标(i,j)处的3×3邻域均值；</td></tr><tr><td class="content" id="description_47">(3b)以参考图像r的灰度特征图I<base:Sub>r</base:Sub>为第一层，在其基础上进行下采样，得到大小为第一层图像1/2的第二层灰度特征图，再在第二层灰度特征图上进行相同下采样，得到大小为第二层灰度特征图1/2的第三层灰度特征图，并将第一层灰度特征图放置在最下层，第二层灰度特征图置于第一层之上，再将第三层灰度特征图置于第二层之上，构成参考图像r的灰度特征金字塔模型A<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_48">(3c)以参考图像r的邻域均差特征图M<base:Sub>r</base:Sub>为第一层，在其基础上进行下采样，得到大小为第一层图像1/2的邻域均差特征图，再在第二层邻域均差特征图上进行相同下采样，得到大小为第二层邻域均差特征图1/2的第三层邻域均差特征图，并将第一层邻域均差特征图放置在最下层，第二层邻域均差特征图置于第一层之上，再将第三层邻域均差特征图置于第二层之上，构成参考图像r的邻域均差特征金字塔模型A<base:Sub>M</base:Sub>；</td></tr><tr><td class="content" id="description_49">(3d)按(3a)相同操作提取浮动图像f的灰度特征图I<base:Sub>f</base:Sub>和邻域均差特征图M<base:Sub>f</base:Sub>；</td></tr><tr><td class="content" id="description_50">(3e)以浮动图像f的灰度特征图I<base:Sub>f</base:Sub>为第一层，在其基础上进行下采样，得到大小为第一层图像1/2的第二层灰度特征图，再在第二层灰度特征图上进行相同下采样，得到大小为第二层灰度特征图1/2的第三层灰度特征图，并将第一层灰度特征图放置在最下层，第二层灰度特征图置于第一层之上，再将第三层灰度特征图置于第二层之上，构成浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_51">(3f)以浮动图像f的邻域均差特征图M<base:Sub>f</base:Sub>为第一层，在其基础上进行下采样，得到大小为第一层图像1/2的第二层邻域均差特征图，再在第二层邻域均差特征图上进行相同下采样，得到大小为第二层邻域均差特征图1/2的第三层邻域均差特征图，并将第一层邻域均差特征图放置在最下层，第二层邻域均差特征图置于第一层之上，再将第三层邻域均差特征图置于第二层之上，构成浮动图像f的邻域均差特征金字塔模型B<base:Sub>M</base:Sub>。</td></tr><tr><td class="content" id="description_52">步骤4.生成参考图像和浮动图形的显著图。</td></tr><tr><td class="content" id="description_53">目前生成显著图的方法比较成熟，常用的有：基于空间频域分析的FT算法、基于图论的GBVS算法和基于分块的C-A算法。本发明采用但不限于下述方法生成参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>，其步骤如下：</td></tr><tr><td class="content" id="description_54">(4a)将参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中的第一层图像分别与δ<base:Sub>1</base:Sub>＝32和δ<base:Sub>2</base:Sub>＝64的两个高斯核进行二维卷积，用该层图像减去卷积后图像，再对两个差分结果图求和并归一化得到第一层图像显著图；</td></tr><tr><td class="content" id="description_55">(4b)将参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中的第二、第三层图像分别与δ<base:Sub>1</base:Sub>＝32和δ<base:Sub>2</base:Sub>＝64的两个高斯核进行二维卷积，用该层图像减去卷积后图像，再对两个差分结果图求和并归一化得到第二、第三层图像显著图；</td></tr><tr><td class="content" id="description_56">(4c)对参考图像灰度特征金字塔模型A<base:Sub>I</base:Sub>中三层显著图求平均，得到参考图像r的灰度特征显著图S<base:Sub>rI</base:Sub>；</td></tr><tr><td class="content" id="description_57">(4d)对参考图像r邻域均差特征金字塔模型A<base:Sub>M</base:Sub>采用(4a)-(4c)相同操作，得到参考图像r的邻域均差特征显著图S<base:Sub>rM</base:Sub>；</td></tr><tr><td class="content" id="description_58">(4e)对参考图像r的灰度特征显著图S<base:Sub>rI</base:Sub>和邻域均差特征显著图S<base:Sub>rM</base:Sub>求和，得到参考图像r的最终显著图S<base:Sub>r</base:Sub>；</td></tr><tr><td class="content" id="description_59">(4f)对浮动图像f的灰度特征金字塔模型B<base:Sub>I</base:Sub>和邻域均差特征金字塔模型B<base:Sub>M</base:Sub>采用(4a)-(4e)相同操作，得到浮动图像f的最终显著图S<base:Sub>f</base:Sub>，如图3所示，其中图3(a)是提取CT图像的显著图，图3(b)是提取TEE图像的显著图。</td></tr><tr><td class="content" id="description_60">步骤5.对参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>进行二值化。</td></tr><tr><td class="content" id="description_61">设置灰度阈值T<base:Sub>1</base:Sub>＝85，利用灰度阈值T<base:Sub>1</base:Sub>分别对参考图像的显著图S<base:Sub>r</base:Sub>和浮动图像的显著图S<base:Sub>f</base:Sub>进行二值化分割：若图像像素点灰度值大于灰度阈值T<base:Sub>1</base:Sub>，则将该像素点灰度值赋值为1，否则赋值为0，得到参考图像显著图的分割结果b<base:Sub>r</base:Sub>和浮动图像显著图的分割结果b<base:Sub>f</base:Sub>，如图4所示，其中图4(a)是对CT图像的二值化结果，图4(b)是对TEE图像的二值化结果。</td></tr><tr><td class="content" id="description_62">步骤6.提取参考图像r和浮动图像f感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和p<base:Sub>f</base:Sub>。</td></tr><tr><td class="content" id="description_63">(6a)统计参考图像最终显著图的分割结果b<base:Sub>r</base:Sub>中各个非连通区域的面积，根据面积大小对各连通区域按降序排序；</td></tr><tr><td class="content" id="description_64">(6b)按(6a)中排序顺序，从第二个非连通区域开始计算各区域与其前一区域面积的比值，并将该比值与设置的面积比阈值T<base:Sub>2</base:Sub>＝0.25进行比较：若该比值大于T<base:Sub>2</base:Sub>，则标记该区域属于感兴趣区域，并继续判断下一区域是否属于感兴趣区域，否则，提取所有在迭代过程中标记为感兴趣区域的区域轮廓点，作为参考图像r的感兴趣区域的轮廓点集p<base:Sub>r</base:Sub>；</td></tr><tr><td class="content" id="description_65">(6c)统计浮动图像最终显著图的分割结果b<base:Sub>f</base:Sub>中各非连通区域的面积，根据面积大小对各连通区域按降序排序；</td></tr><tr><td class="content" id="description_66">(6d)按(6c)中排序顺序，从第二个非连通区域开始计算各区域与其前一区域面积的比值，并将该比值与设置的面积比阈值T<base:Sub>2</base:Sub>＝0.25进行比较：若该比值大于T<base:Sub>2</base:Sub>，则标记该区域属于感兴趣区域，并继续判断下一区域是否属于感兴趣区域，否则，提取所有在迭代过程中标记为感兴趣区域的区域轮廓点，作为浮动图像f的感兴趣区域的轮廓点集p<base:Sub>f</base:Sub>，如图5所示，其中图5(a)表示提取的参考图像感兴趣区域，图5(b)表示提取的浮动图像感兴趣区域。</td></tr><tr><td class="content" id="description_67">步骤7.根据参考图像感兴趣区域和浮动图像感兴趣区域质心间的距离对参考图像和浮动图像进行粗配准。</td></tr><tr><td class="content" id="description_68">分别提取参考图像r中感兴趣区域的质心(x<base:Sub>r</base:Sub>,y<base:Sub>r</base:Sub>)和浮动图像f中感兴趣区域的质心(x<base:Sub>f</base:Sub>,y<base:Sub>f</base:Sub>)，计算两区域质心间的距离(Δx,Δy)，并将浮动图像f和其感兴趣区域轮廓点集f分别横向平移Δx个像素，纵向平移Δy个像素，得到粗配准结果图f'和粗配准结果图的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>。</td></tr><tr><td class="content" id="description_69">步骤8.采用迭代最近点ICP算法进行精配准，得到配准参数。</td></tr><tr><td class="content" id="description_70">以参考图像r的感兴趣区域轮廓点集p<base:Sub>r</base:Sub>和粗配准结果图f'的感兴趣区域轮廓点集p'<base:Sub>f</base:Sub>作为输入，使用迭代最近点ICP算法进行精配准，得到两点集之间的旋转矩阵TR和平移矩阵TT。</td></tr><tr><td class="content" id="description_71">步骤9.根据配准参数得到最终配准结果。</td></tr><tr><td class="content" id="description_72">将粗配准结果图f'按旋转矩阵TR和平移矩阵TT依次进行旋转和平移操作，得到最终配准结果q，完成配准工作，最终配准结果图如图6所示。</td></tr><tr><td class="content" id="description_73">本发明的效果可通过以下仿真实验进一步说明：</td></tr><tr><td class="content" id="description_74">实验内容：</td></tr><tr><td class="content" id="description_75">为了说明本发明的精确性和高效性，实验所使用的输入图像为来自同一个人的心脏CT图像和超声TEE图像，如图7所示，其中图7(a)是CT图像，图7(b)是TEE图像。</td></tr><tr><td class="content" id="description_76">以7(a)所示的CT图像为参考图像，以图7(b)所示的TEE图像为浮动图像，采用本发明对其进行配准，配准结果如图8所示，从图8可以看出，本发明对CT图像和超声图像配准的精确度高。</td></tr><tr><td class="content" id="description_77">对图像配准前后目标配准误差和配准时间进行统计，结果如表一。</td></tr><tr><td class="content" id="description_78">表一评价指标</td></tr><tr><td class="content" id="description_79"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4427510160&amp;blobId=3678077178" width="492"/></td></tr><tr><td class="content" id="description_80">由表一可以看出，采用本发明进行配准的目标配准误差与配准前相比有大幅提高，而且运行时间短，满足图像引导手术对配准精度和配准时间的要求。</td></tr></table></div></body></html>
<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1"><business:ClaimText>1.一种基于探针的手术导航空间配准方法，其特征在于，其包括步骤：</business:ClaimText></td></tr><tr><td class="content" id="claim_2"><business:ClaimText>(1)使用探针获取病人空间点云；</business:ClaimText></td></tr><tr><td class="content" id="claim_3"><business:ClaimText>(2)将探针获取到的病人空间点云与图像空间点云采用点云的共面四点配准方法进行配准，获得两组点云的初步配准结果；</business:ClaimText></td></tr><tr><td class="content" id="claim_4"><business:ClaimText>(3)使用点云的迭代配准方法，将初步配准结果再次进行配准。</business:ClaimText></td></tr><tr><td class="content" id="claim_5"><business:ClaimText>2.根据权利要求1所述的方法，其特征在于，所述步骤(1)中，在空间定位仪的追踪下，在所述病人空间中，使用探针获取一组病人面部点云。</business:ClaimText></td></tr><tr><td class="content" id="claim_6"><business:ClaimText>3.根据权利要求1所述的方法，其特征在于，所述步骤(2)中，用探针所获点组成的点云与图像空间中的点云采用共面四点的配准方法进行配准；</business:ClaimText></td></tr><tr><td class="content" id="claim_7"><business:ClaimText>所述点云的共面四点配准方法中，以一个点云中的共面四点为基础点集，在另一个点云中通过仿射不变性提取所有的近似共面全等四点，并基于最小平方距离准则，分别计算变换关系，选出最佳变换关系，按下述步骤：</business:ClaimText></td></tr><tr><td class="content" id="claim_8"><business:ClaimText>①在图像空间点云中选取一个基础四点集，首先随机选取三个点，然后再选取一个与前三个点近似共面的点，组成一组共面四点作为基础点集；</business:ClaimText></td></tr><tr><td class="content" id="claim_9"><business:ClaimText>②根据仿射不变性，对于给定的三个共线点{a,b,c}，|a-b|/|a-c|保持不变；则对于选出的共面四点集，其四点不全共线，直线ab和cd相交于点e，比率r<base:Sub>1</base:Sub>和r<base:Sub>2</base:Sub>在仿射变换下保持不变，</business:ClaimText></td></tr><tr><td class="content" id="claim_10"><business:ClaimText>r<base:Sub>1</base:Sub>＝|a-e|/|a-b|</business:ClaimText></td></tr><tr><td class="content" id="claim_11"><business:ClaimText>r<base:Sub>2</base:Sub>＝|c-e|/|c-d|  (1)</business:ClaimText></td></tr><tr><td class="content" id="claim_12"><business:ClaimText>③根据上述方法选出基础点集后，在探针获取的病人空间点云中，根据距离d<base:Sub>1</base:Sub>＝|a-b|,d<base:Sub>2</base:Sub>＝|c-d|,找到距离近似相等的点对，根据式(1)计算仿射不变比率r<base:Sub>1</base:Sub>和r<base:Sub>2</base:Sub>，计算点对的交叉点</business:ClaimText></td></tr><tr><td class="content" id="claim_13"><business:ClaimText>e<base:Sub>1</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>1</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)</business:ClaimText></td></tr><tr><td class="content" id="claim_14"><business:ClaimText>e<base:Sub>2</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>2</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)  (2)</business:ClaimText></td></tr><tr><td class="content" id="claim_15"><business:ClaimText>对于任意两个点对，如果e<base:Sub>1</base:Sub>＝e<base:Sub>2</base:Sub>，认为这两个点对组成一组对应四点集，按照所述方法，得到基础点集的所有近似共面全等四点，并基于最小平方距离准则，分别计算变换关系，选出基于该基础点集的最佳变换关系；</business:ClaimText></td></tr><tr><td class="content" id="claim_16"><business:ClaimText>④重复步骤①-③，直至得到一个全局配准精度达到要求的点云变换关系。</business:ClaimText></td></tr><tr><td class="content" id="claim_17"><business:ClaimText>4.根据权利要求1或3所述的方法，其特征在于，所述步骤(3)中，对共面四点配准方法得到的初步配准结果，使用点云的迭代配准方法再次进行配准，按下述步骤：</business:ClaimText></td></tr><tr><td class="content" id="claim_18"><business:ClaimText>①对于病人空间中的每一个点，在图像空间中，找到一个距离最近的对应点；</business:ClaimText></td></tr><tr><td class="content" id="claim_19"><business:ClaimText>②获取所有点的对应点后，去除对应点距离过大的噪声点，然后计算变换矩阵[RT]；</business:ClaimText></td></tr><tr><td class="content" id="claim_20"><business:ClaimText>③用上述的变换矩阵[RT]对所述病人空间点云进行变换；</business:ClaimText></td></tr><tr><td class="content" id="claim_21"><business:ClaimText>④重复步骤①-③，直到获得一个配准精度达到预设要求的点云变换关系。</business:ClaimText></td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table style="table-layout:fixed"><tr><td id="description_title" class="header">
						说明书
					</td></tr><tr><td class="content" id="description_invention_title">一种基于探针的手术导航空间配准方法</td></tr><tr><td class="content" id="description_1">技术领域</td></tr><tr><td class="content" id="description_2">本发明属于医疗器械领域，具体涉及一种基于探针的可用于手术导航的空间配准方法。</td></tr><tr><td class="content" id="description_3">背景技术</td></tr><tr><td class="content" id="description_4">现有技术公开了手术导航系统能够在手术中跟踪手术器械的位置并实时显示，其中，需要术前获取的病人医学影像数据空间，能够与手术时的病人空间对应起来。目前主流的手术导航配准方法，包括点匹配和面匹配；所述点匹配，是通过两个空间中少量标记点的对应关系确定病人空间与图像空间的对应关系，点匹配应用广泛，但存在一些固有缺陷，包括：点匹配需要人工放置标记物，然后额外执行一次影像扫描，增加病人的经济负担；人工标记物容易脱落、移位，导致配准精度降低；人工标记物在配准时需要手动识别，容易产生误差，且识别标记点时间较长；所述面匹配不需要人工标记物，使用点云自身的特征进行配准，不需要额外的影像扫描，但实践显示，配准的效率较低，容易陷入局部最优解。</td></tr><tr><td class="content" id="description_5">有研究显示，计算两组点云直接的对应关系，有几种可行的方法；其中，共面四点的配准方法，是在一个点云中随机选取一组共面四点，然后在另一个点云中搜索与之匹配的全等共面四点，以完成配准，该方法对初始位置不敏感，但配准效率较低，而且点云选取的随机性导致配准的结果不稳定；点云迭代的配准方法，是查找两组点云所有的点对信息，然后根据点对计算新的点云对应关系，反复迭代，得到最终的点云变换矩阵，该方法配准速度较快，精度稳定，但，对初始位置要求高，可能陷入局部最优。</td></tr><tr><td class="content" id="description_6">因此，目前需要一种新的点云配准方法，能够结合上述两种配准方法的优点，不需额外影像扫描和人工标记物，使用较多的特征点信息，减小配准误差，提高配准效率，对初始位置不敏感。</td></tr><tr><td class="content" id="description_7">基于现有技术的现状，本发明拟提供一种基于探针获取病人空间的面部表面点云进行配准的方法，将为手术导航系统提供快速、可靠的配准结果。</td></tr><tr><td class="content" id="description_8">发明内容</td></tr><tr><td class="content" id="description_9">本发明的目的在于基于现有技术的现状，提供一种基于探针的手术导航空间配准方法，尤其涉及基于探针获取面部点云进行面匹配的手术导航配准方法。</td></tr><tr><td class="content" id="description_10">本发明采用共面四点配准与点云迭代配准相结合的方法，即：借助空间定位仪使术中病人空间与图像空间对应，然后使用探针，在病人头部表面获取特征点，得到的特征点组成一组稀疏的点云，与图像空间中截取的面部点云进行共面四点配准，得到初步配准结果；根据初步配准结果再使用点云迭代配准方法再次配准，最终得到精确的配准结果。</td></tr><tr><td class="content" id="description_11">本发明中，</td></tr><tr><td class="content" id="description_12">共面四点的配准方法，是使用探针在病人面部获取点，通过空间定位仪，获得探针取到的点在病人空间中的坐标，然后用探针所获点组成的点云与图像空间中的点云采用共面四点的配准方法进行配准；</td></tr><tr><td class="content" id="description_13">点云迭代的配准方法，是将共面四点配准得到的初步配准结果，使用点云迭代的方法再次配准。</td></tr><tr><td class="content" id="description_14">具体而言，本发明的手术导航空间配准方法，其特征在于，其包括步骤：</td></tr><tr><td class="content" id="description_15">(1)探针获取病人空间点云</td></tr><tr><td class="content" id="description_16">在空间定位仪的追踪下，使用探针获取病人面部空间点云数据；</td></tr><tr><td class="content" id="description_17">(2)点云的共面四点配准方法</td></tr><tr><td class="content" id="description_18">从任意初始位置进行自动配准，以一个点云中的共面四点为基础点集，在另一个点云中通过仿射不变性提取所有的近似共面全等四点，并基于最小平方距离准则，分别计算变换关系并选出最佳的变换关系；其包括下述步骤：</td></tr><tr><td class="content" id="description_19">①在图像空间点云中选取一个基础四点集，首先随机选取三个点，然后再选取一个与前三个点近似共面的点，组成一组共面四点作为基础点集；</td></tr><tr><td class="content" id="description_20">②根据仿射不变性，对于给定的三个共线点{a,b,c}，|a-b|/|a-c|保持不变；对于选出的共面四点集，其四点不全共线，直线ab和cd相交于点e，比率r<base:Sub>1</base:Sub>和r<base:Sub>2</base:Sub>在仿射变换下保持不变，</td></tr><tr><td class="content" id="description_21">r<base:Sub>1</base:Sub>＝|a-e|/|a-b|</td></tr><tr><td class="content" id="description_22">r<base:Sub>2</base:Sub>＝|c-e|/|c-d|  (1)</td></tr><tr><td class="content" id="description_23">③根据上述方法选出基础点集后，在探针获取的病人空间点云中，根据距离d<base:Sub>1</base:Sub>＝|a-b|,d<base:Sub>2</base:Sub>＝|c-d|,找到距离近似相等的点对，根据式(1)计算仿射不变比率r<base:Sub>1</base:Sub>和r<base:Sub>2</base:Sub>，计算点对的交叉点</td></tr><tr><td class="content" id="description_24">e<base:Sub>1</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>1</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)</td></tr><tr><td class="content" id="description_25">e<base:Sub>2</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>2</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)  (2)</td></tr><tr><td class="content" id="description_26">对于任意两个点对，如果e<base:Sub>1</base:Sub>＝e<base:Sub>2</base:Sub>，认为这两个点对组成一组对应四点集；</td></tr><tr><td class="content" id="description_27">按照所述方法，得到基础点集的所有近似共面全等四点，并基于最小平方距离准则，分别计算变换关系，选出基于该基础点集的最佳变换关系；</td></tr><tr><td class="content" id="description_28">④重复步骤①-③，直到得到一个全局配准精度达到要求的点云变换关系；</td></tr><tr><td class="content" id="description_29">(3)点云的迭代配准方法</td></tr><tr><td class="content" id="description_30">利用步骤(2)得到的点云变换关系，将获得的病人的空间的点云变换到图像空间中，然后使用点云的迭代配准方法，再次进行配准，以提高配准精度；点云迭代配准方法的目标是寻找使两组点云对应点之间的平均距离最小的一个空间变换关系，用D＝{d<base:Sub>i</base:Sub>,...d<base:Sub>n</base:Sub>}和M＝{m<base:Sub>i</base:Sub>,...m<base:Sub>n</base:Sub>}分别表示所述的病人空间和图像空间点云，R和T表示点云变换关系中的旋转矩阵和平移矩阵，则通过最小化式</td></tr><tr><td class="content" id="description_31"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4028688879&amp;blobId=3407026424" width="492"/></td></tr><tr><td class="content" id="description_32">(4)得到最优的变换关系，其中d<base:Sub>i</base:Sub>的对应点m<base:Sub>j</base:Sub>为图像空间点云中与d<base:Sub>i</base:Sub>距离最小的点；</td></tr><tr><td class="content" id="description_33">为了提高配准精度，所述点云的迭代配准方法中还去除一部分噪声点，按下述步骤：</td></tr><tr><td class="content" id="description_34">①对于所述病人空间中的每一个点，在图像空间中，找到一个距离最佳的对应点；</td></tr><tr><td class="content" id="description_35">②获取所有点的对应点后，去除对应点距离过大的噪声点，然后计算变换矩阵[RT]；</td></tr><tr><td class="content" id="description_36">③用上述的变换矩阵[R T]对所述病人空间点云进行变换；</td></tr><tr><td class="content" id="description_37">④重复步骤①-③，直到获得一个配准精度达到预设要求的点云变换关系。</td></tr><tr><td class="content" id="description_38">本发明的手术导航空间配准方法与现有技术相比，具有以下优点：</td></tr><tr><td class="content" id="description_39">(1)解决了传统点匹配和面匹配存在的缺陷，不需要额外放置标记物和影像扫描，对点云的初始位置不敏感；</td></tr><tr><td class="content" id="description_40">(2)与传统方法相比，增加了去除噪声点的步骤，减小了噪声对配准精度的影响；</td></tr><tr><td class="content" id="description_41">(3)使用探针取点不局限于指定的特征点，使术中的操作更加方便，而且获取的点数量更多，为配准提供更多的特征；</td></tr><tr><td class="content" id="description_42">(4)减少配准时间，提高配准精度。</td></tr><tr><td class="content" id="description_43">本发明提供了一种基于探针获取面部点云进行面匹配的手术导航配准方法，其中，借助空间定位仪使术中病人空间与图像空间对应，然后使用探针，在病人头部表面获取特征点，得到的特征点组成一组稀疏的点云，与图像空间中截取的面部点云进行共面四点配准，得到初步配准结果；根据初步配准结果再使用点云迭代配准方法再次配准，最终得到精确的配准结果。本方法能够提高手术导航系统配准的速度和精度，操作简便，易于实现，在手术导航系统中具有很高的实用价值。</td></tr><tr><td class="content" id="description_44">具体实施方式</td></tr><tr><td class="content" id="description_45">实施例1</td></tr><tr><td class="content" id="description_46">本发明的基于探针的手术导航空间配准方法，包括以下步骤：</td></tr><tr><td class="content" id="description_47">(1)探针获取病人空间点云</td></tr><tr><td class="content" id="description_48">在空间定位仪的追踪下，使用探针获取一组在病人面部的空间点云；</td></tr><tr><td class="content" id="description_49">(2)点云的共面四点配准方法</td></tr><tr><td class="content" id="description_50">从病人的医学影像数据中，获得图像空间的待配准点云，将探针获取到的病人空间点云与待配准点云采用点云的共面四点配准方法进行配准，获得两组点云的初步配准，按下述步骤：</td></tr><tr><td class="content" id="description_51">①在图像空间点云中选取一个基础四点集，首先随机选取三个点，然后再选取一个与前三个点近似共面的点，组成一组共面四点作为基础点集；</td></tr><tr><td class="content" id="description_52">②根据上述方法选出基础点集后，在探针获取的病人空间点云中，根据距离d<base:Sub>1</base:Sub>＝|a-b|,d<base:Sub>2</base:Sub>＝|c-d|,找到距离近似相等的点对，根据式(1)计算仿射不变比率r<base:Sub>1</base:Sub>和r<base:Sub>2</base:Sub>，</td></tr><tr><td class="content" id="description_53">r<base:Sub>1</base:Sub>＝|a-e|/|a-b|</td></tr><tr><td class="content" id="description_54">r<base:Sub>2</base:Sub>＝|c-e|/|c-d|  (1)</td></tr><tr><td class="content" id="description_55">由式(2)计算点对的交叉点e<base:Sub>1</base:Sub>，e<base:Sub>2</base:Sub>，对于任意两个点对，如果e<base:Sub>1</base:Sub>＝e<base:Sub>2</base:Sub>，认为这两个点对组成一组对应四点集，按照所述方法，得到所有基础点集的近似共面全等四点，并基于最小平方距离准则，分别计算变换关系，选出基于该基础点集的最佳变换关系；</td></tr><tr><td class="content" id="description_56">e<base:Sub>1</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>1</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)</td></tr><tr><td class="content" id="description_57">e<base:Sub>2</base:Sub>＝q<base:Sub>1</base:Sub>+r<base:Sub>2</base:Sub>(q<base:Sub>2</base:Sub>-q<base:Sub>1</base:Sub>)  (2)</td></tr><tr><td class="content" id="description_58">③重复步骤①和②，直至得到一个全局配准精度达到要求的点云变换关系；</td></tr><tr><td class="content" id="description_59"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4028688906&amp;blobId=3407026674" width="492"/></td></tr><tr><td class="content" id="description_60">(3)点云的迭代配准方法</td></tr><tr><td class="content" id="description_61">对得到初步配准结果的两组点云，使用点云的迭代配准方法再次配准，其中，对于病人空间中的每一个点，在图像空间中，找到一个距离最近的对应点；获取所有点的对应点后，去除对应点距离过大的噪声点，然后计算变换矩阵[R T]；用上述的变换矩阵[R T]对所述病人空间点云进行变换；重复上述步骤，直到获得一个配准精度达到预设要求的点云变换关系。</td></tr><tr><td class="content" id="description_62">本发明的实施例的结果表明，本发明能够克服传统点匹配和面匹配的固有缺陷，提高手术导航空间配准的速度和精度；所述方法能够去除噪声，降低了噪声对配准精度的影响；探针取点的限制减少，简化了操作流程，降低操作复杂度，同时增加了点的数量，为配准提供更多特征；所述方法实施简便，精度可靠，应用在手术导航系统中，能够大幅提高导航系统的配准精度。</td></tr></table></div></body></html>
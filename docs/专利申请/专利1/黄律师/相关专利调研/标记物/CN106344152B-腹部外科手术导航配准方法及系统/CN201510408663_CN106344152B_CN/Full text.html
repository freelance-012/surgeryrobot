<html><head><title>全文文本(Fulltext)</title><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><style>div.fullText table {width: 100%;text-indent: 1px;} 
 div.fullText table td.header {font-weight: bold;text-align: center;font-family: '宋体';font-size: 16px;line-height:20px;color: #000000;padding: 5px;}div.fullText table td.content {padding: 1px;text-align: left;vertical-align: top;width: 100%;font-family: '宋体';font-size: 14px;line-height:20px;color: #000000;}</style></head><body><?xml version="1.0" encoding="UTF-8"?><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table><tr><td id="claim_title" class="header">权利要求书</td></tr><tr><td class="content" id="claim_1"><business:ClaimText>1.一种腹部外科手术导航配准系统，其特征在于，所述系统包括：</business:ClaimText></td></tr><tr><td class="content" id="claim_2"><business:ClaimText>第一表面数据提取模块：用于获取手术区域的术前CT图像，并从所述术前CT图像中提取手术区域的术前表面数据；</business:ClaimText></td></tr><tr><td class="content" id="claim_3"><business:ClaimText>第二表面数据提取模块：用于获取手术区域的术中RGB-D图像，并从所述术中RGB-D图像中提取手术区域的术中表面数据；</business:ClaimText></td></tr><tr><td class="content" id="claim_4"><business:ClaimText>配准模块：用于建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，并根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_5"><business:ClaimText>导航模块：用于根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程，其中，所述第一表面数据提取模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_6"><business:ClaimText>采用区域增长算法对所述术前CT图像进行分割处理，提取出所述术前CT图像的腹部区域表面；</business:ClaimText></td></tr><tr><td class="content" id="claim_7"><business:ClaimText>根据所述术前CT图像在人体矢状面方向的索引值对所述腹部区域表面进行分割处理，提取出腹部表面手术区域，并清除所述腹部表面手术区域之外的冗余像素。</business:ClaimText></td></tr><tr><td class="content" id="claim_8"><business:ClaimText>2.如权利要求1所述的腹部外科手术导航配准系统，其特征在于，所述第一表面数据提取模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_9"><business:ClaimText>将所述提取出的腹部表面手术区域投影到冠状面方向，生成术前二维投影图像；</business:ClaimText></td></tr><tr><td class="content" id="claim_10"><business:ClaimText>提取所述术前二维投影图像的轮廓，并重构形成术前二维形状图像，进而由所述术前二维形状图像提取所述术前表面数据。</business:ClaimText></td></tr><tr><td class="content" id="claim_11"><business:ClaimText>3.如权利要求2所述的腹部外科手术导航配准系统，其特征在于，所述术中RGB-D图像包括RGB图像和深度图像，所述第二表面数据提取模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_12"><business:ClaimText>采用分水岭算法对所述RGB图像进行分割处理，提取出标签图像；</business:ClaimText></td></tr><tr><td class="content" id="claim_13"><business:ClaimText>采用阈值法对所述深度图像进行分割处理，提取出阈值图像；</business:ClaimText></td></tr><tr><td class="content" id="claim_14"><business:ClaimText>将所述阈值图像作为模板与所述标签图像进行与操作，获得初始ROI模板图像；</business:ClaimText></td></tr><tr><td class="content" id="claim_15"><business:ClaimText>将所述初始ROI模板图像作为种子，采用区域增长算法对所述深度图像进行再分割处理，获得最终ROI模板图像。</business:ClaimText></td></tr><tr><td class="content" id="claim_16"><business:ClaimText>4.如权利要求3所述的腹部外科手术导航配准系统，其特征在于，所述第二表面数据提取模块还用于对所述最终ROI模板图像进行旋转调整，所述旋转调整包括：</business:ClaimText></td></tr><tr><td class="content" id="claim_17"><business:ClaimText>对所述最终ROI模板图像进行分割处理，提取出ROI轮廓；</business:ClaimText></td></tr><tr><td class="content" id="claim_18"><business:ClaimText>计算所述ROI轮廓的质心与所述ROI轮廓上每个点的距离，并按升序排列；</business:ClaimText></td></tr><tr><td class="content" id="claim_19"><business:ClaimText>分别对排列两端各3％的距离取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义出一个矩形区域；</business:ClaimText></td></tr><tr><td class="content" id="claim_20"><business:ClaimText>将所述最终ROI模板图像与所述矩形区域进行配准处理，获得调整后的ROI模板图像，并由所述调整后的ROI模版图像生成所述术中表面数据。</business:ClaimText></td></tr><tr><td class="content" id="claim_21"><business:ClaimText>5.如权利要求4所述的腹部外科手术导航配准系统，其特征在于，所述由所述调整后的ROI模版图像生成所述术中表面数据，包括：</business:ClaimText></td></tr><tr><td class="content" id="claim_22"><business:ClaimText>以所述最小距离与所述最大距离分别作为术中二维形状图像矩形区域的宽和长，并保持术中二维形状图像的质心位置与所述术前二维形状图像的质心位置一致，得到术中二维形状图像；</business:ClaimText></td></tr><tr><td class="content" id="claim_23"><business:ClaimText>由所述术中二维形状图像提取所述术中表面数据。</business:ClaimText></td></tr><tr><td class="content" id="claim_24"><business:ClaimText>6.如权利要求5所述的腹部外科手术导航配准系统，其特征在于，所述配准模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_25"><business:ClaimText>对所述术前二维形状图像和所述术中二维形状图像进行配准处理，以建立所述术前表面数据和所述术中表面数据之间的索引关系；</business:ClaimText></td></tr><tr><td class="content" id="claim_26"><business:ClaimText>根据所述索引关系，搜索所述术前CT图像和所述术中RGB-D图像上的对应点；</business:ClaimText></td></tr><tr><td class="content" id="claim_27"><business:ClaimText>根据所述对应点，采用最小二乘匹配算法计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</business:ClaimText></td></tr><tr><td class="content" id="claim_28"><business:ClaimText>7.如权利要求6所述的腹部外科手术导航配准系统，其特征在于，所述术前图像空间包括二维图像索引坐标系，所述术中物理空间包括定位系统坐标系、深度相机坐标系及相机工具坐标系，所述定位系统坐标系与所述二维图像索引坐标系之间的变换关系记为T<base:Sub>Tracker2Img</base:Sub>变换，所述定位系统坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Tracker2ToF</base:Sub>变换，所述二维图像索引坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Img2ToF</base:Sub>变换，所述深度相机坐标系与所述相机工具坐标系之间的变换关系记为T<base:Sub>ToF2Ref</base:Sub>变换，所述相机工具坐标系与所述定位系统坐标系之间的变换关系记为T<base:Sub>Ref2Tracker</base:Sub>变换。</business:ClaimText></td></tr><tr><td class="content" id="claim_29"><business:ClaimText>8.如权利要求7所述的腹部外科手术导航配准系统，其特征在于，所述T<base:Sub>Tracker2Img</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2ToF</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I；所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I，其中，I为单位矩阵。</business:ClaimText></td></tr><tr><td class="content" id="claim_30"><business:ClaimText>9.如权利要求8所述的腹部外科手术导航配准系统，其特征在于，所述二维图像索引坐标系与所述深度相机坐标系之间的T<base:Sub>Img2ToF</base:Sub>变换形成所述第一空间变换T<base:Sub>1</base:Sub>；所述定位系统坐标系与所述二维图像索引坐标系之间的T<base:Sub>Tracker2Img</base:Sub>变换形成所述第二空间变换T<base:Sub>2</base:Sub>；所述T<base:Sub>Ref2Tracker</base:Sub>变换由所述定位系统实时捕获。</business:ClaimText></td></tr><tr><td class="content" id="claim_31"><business:ClaimText>10.如权利要9所述的腹部外科手术导航配准系统，其特征在于，在选定某一时刻，并固定所述定位系统、深度相机和相机工具之间的空间位置的条件下，从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'，则所述配准模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_32"><business:ClaimText>通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；</business:ClaimText></td></tr><tr><td class="content" id="claim_33"><business:ClaimText>通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</business:ClaimText></td></tr><tr><td class="content" id="claim_34"><business:ClaimText>由关系式T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>计算所述深度相机坐标系与所述相机工具坐标系之间的T<base:Sub>ToF2Ref</base:Sub>变换；</business:ClaimText></td></tr><tr><td class="content" id="claim_35"><business:ClaimText>由关系式P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>将所述深度相机获取的任一标记点P<base:Sub>ToF</base:Sub>变换至所述定位系统坐标系中，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</business:ClaimText></td></tr><tr><td class="content" id="claim_36"><business:ClaimText>根据所述关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I及所述第一空间变换T<base:Sub>1</base:Sub>，计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>。</business:ClaimText></td></tr><tr><td class="content" id="claim_37"><business:ClaimText>11.如权利要求10所述的腹部外科手术导航配准系统，其特征在于，所述导航模块还用于：</business:ClaimText></td></tr><tr><td class="content" id="claim_38"><business:ClaimText>将所述定位系统获取的所述穿刺工具在所述物理空间中的坐标记为P<base:Sub>T</base:Sub>，将所述穿刺工具在所述术前图像空间中的坐标记为P<base:Sub>I</base:Sub>；</business:ClaimText></td></tr><tr><td class="content" id="claim_39"><business:ClaimText>通过关系式P<base:Sub>I</base:Sub>＝T<base:Sub>2</base:Sub>·P<base:Sub>T</base:Sub>将所述穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中。</business:ClaimText></td></tr></table></div><div xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:siposeas="java:com.neusoft.sipo.sipopublicsearch.search.app.view.detailUtils.xsltParser.XsltSeasParser" xmlns:str="http://example.com/namespace" xmlns:business="http://www.sipo.gov.cn/XMLSchema/business" xmlns:base="http://www.sipo.gov.cn/XMLSchema/base" xmlns:tbl="http://oasis-open.org/specs/soextblx" class="fullText"><table style="table-layout:fixed"><tr><td id="description_title" class="header">
						说明书
					</td></tr><tr><td class="content" id="description_invention_title">腹部外科手术导航配准方法及系统</td></tr><tr><td class="content" id="description_1">技术领域</td></tr><tr><td class="content" id="description_2">本发明涉及医学图像处理领域，尤其涉及一种腹部外科手术导航配准方法及系统。</td></tr><tr><td class="content" id="description_3">背景技术</td></tr><tr><td class="content" id="description_4">配准过程是手术导航一个至关重要的步骤，它的主要作用是将术前图像空间与术中物理空间统一起来。手术导航过程中，手术器械等物理空间下的物体通过配准过程所计算的空间变换，即可在术前图像空间中实时显示，手术器械与人体解剖结构之间的相对位置亦可在计算机屏幕上实时展现。</td></tr><tr><td class="content" id="description_5">在传统的手术导航中，如神经外科手术导航系统，一般需要在术前和术中人工干预选取标记点，然后将这两组标记点做最小二乘运算，求取术前图像空间与术中物理空间之间的空间变换。由于人工选取标记点具有很强的主观性与不稳定性，不同的操作者选取的结果不尽相同，同一操作者在不同的时刻所得的结果也不一样，从而导致误差过大，影响导航系统最终的精度；手术过程中如果病人手术区域发生形变时，也会影响到配准精度；另一方面，人工干预选取标记点也使得外科手术导航过程复杂繁琐。</td></tr><tr><td class="content" id="description_6">发明内容</td></tr><tr><td class="content" id="description_7">本发明提供一种腹部外科手术导航配准方法，在手术导航过程中无须粘贴外部标记点，从而可以避免标记点选取所带来的操作上的不便以及手动选取标记点的潜在错误会导致配准结果误差过大的问题，实现整个手术导航过程的自动化配准。</td></tr><tr><td class="content" id="description_8">另，本发明还提供一种应用所述方法的腹部外科手术导航配准系统。</td></tr><tr><td class="content" id="description_9">一种腹部外科手术导航配准方法，包括：</td></tr><tr><td class="content" id="description_10">获取手术区域的术前CT图像，并从所述术前CT图像中提取手术区域的术前表面数据；</td></tr><tr><td class="content" id="description_11">获取手术区域的术中RGB-D图像，并从所述术中RGB-D图像中提取手术区域的术中表面数据；</td></tr><tr><td class="content" id="description_12">建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，并根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>；</td></tr><tr><td class="content" id="description_13">根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程。</td></tr><tr><td class="content" id="description_14">其中，所述获取手术区域的术前CT图像之后，还包括：</td></tr><tr><td class="content" id="description_15">在所述术前CT图像上选取穿刺的入口点和目标靶点，所述入口点和目标靶点的连线形成穿刺路径。</td></tr><tr><td class="content" id="description_16">其中，所述在所述术前CT图像上选取穿刺的入口点和目标靶点，包括：</td></tr><tr><td class="content" id="description_17">通过手动选取所述入口点；</td></tr><tr><td class="content" id="description_18">通过自动分割算法从所述术前CT图像中分割出病变区，并计算所述病变区的质点位置为所述目标靶点。</td></tr><tr><td class="content" id="description_19">其中，所述从所述术前CT图像中提取手术区域的术前表面数据，包括：</td></tr><tr><td class="content" id="description_20">采用区域增长算法对所述术前CT图像进行分割处理，提取出所述术前CT图像的腹部区域表面；</td></tr><tr><td class="content" id="description_21">根据所述术前CT图像在人体矢状面方向的索引值对所述腹部区域表面进行分割处理，提取出腹部表面手术区域，并清除所述腹部表面手术区域之外的冗余像素。</td></tr><tr><td class="content" id="description_22">其中，所述提取出腹部表面手术区域之后，还包括：</td></tr><tr><td class="content" id="description_23">将所述提取出的腹部表面手术区域投影到冠状面方向，生成术前二维投影图像；</td></tr><tr><td class="content" id="description_24">提取所述术前二维投影图像的轮廓，并重构形成术前二维形状图像，进而由所述术前二维形状图像提取所述术前表面数据。</td></tr><tr><td class="content" id="description_25">其中，所述术中RGB-D图像包括RGB图像和深度图像，则所述从所述术中RGB-D图像中提取手术区域的术中表面数据，包括：</td></tr><tr><td class="content" id="description_26">采用分水岭算法对所述RGB图像进行分割处理，提取出标签图像；</td></tr><tr><td class="content" id="description_27">采用阈值法对所述深度图像进行分割处理，提取出阈值图像；</td></tr><tr><td class="content" id="description_28">将所述阈值图像作为模板与所述标签图像进行与操作，获得初始ROI模板图像；</td></tr><tr><td class="content" id="description_29">将所述初始ROI模板图像作为种子，采用区域增长算法对所述深度图像进行再分割处理，获得最终ROI模板图像。</td></tr><tr><td class="content" id="description_30">其中，所述获得最终ROI模板图像后，还包括对所述最终ROI模板图像进行旋转调整，所述旋转调整包括：</td></tr><tr><td class="content" id="description_31">对所述最终ROI模板图像进行分割处理，提取出ROI轮廓；</td></tr><tr><td class="content" id="description_32">计算所述ROI轮廓的质心与所述ROI轮廓上每个点的距离，并按升序排列；</td></tr><tr><td class="content" id="description_33">分别对排列两端各3％的距离取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义出一个矩形区域；</td></tr><tr><td class="content" id="description_34">将所述最终ROI模板图像与所述矩形区域进行配准处理，获得调整后的ROI模板图像，并由所述调整后的ROI模版图像生成所述术中表面数据。</td></tr><tr><td class="content" id="description_35">其中，所述由所述调整后的ROI模版图像生成所述术中表面数据，包括：</td></tr><tr><td class="content" id="description_36">以所述最小距离与所述最大距离分别作为术中二维形状图像矩形区域的宽和长，并保持术中二维形状图像的质心位置与所述术前二维形状图像的质心位置一致，得到术中二维形状图像；</td></tr><tr><td class="content" id="description_37">由所述术中二维形状图像提取所述术中表面数据。</td></tr><tr><td class="content" id="description_38">其中，所述建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，包括：</td></tr><tr><td class="content" id="description_39">对所述术前二维形状图像和所述术中二维形状图像进行配准处理，以建立所述术前表面数据和所述术中表面数据之间的索引关系；</td></tr><tr><td class="content" id="description_40">根据所述索引关系，搜索所述术前CT图像和所述术中RGB-D图像上的对应点；</td></tr><tr><td class="content" id="description_41">根据所述对应点，采用最小二乘匹配算法计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_42">其中，所述术前图像空间包括二维图像索引坐标系，所述术中物理空间包括定位系统坐标系、深度相机坐标系及相机工具坐标系，所述定位系统坐标系与所述二维图像索引坐标系之间的变换关系记为T<base:Sub>Tracker2Img</base:Sub>变换，所述定位系统坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Tracker2ToF</base:Sub>变换，所述二维图像索引坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Img2ToF</base:Sub>变换，所述深度相机坐标系与所述相机工具坐标系之间的变换关系记为T<base:Sub>ToF2Ref</base:Sub>变换，所述相机工具坐标系与所述定位系统坐标系之间的变换关系记为T<base:Sub>Ref2Tracker</base:Sub>变换。</td></tr><tr><td class="content" id="description_43">其中，所述T<base:Sub>Tracker2Img</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2ToF</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I；所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I，其中，I为单位矩阵。</td></tr><tr><td class="content" id="description_44">其中，所述二维图像索引坐标系与所述深度相机坐标系之间的T<base:Sub>Img2ToF</base:Sub>变换形成所述第一空间变换T<base:Sub>1</base:Sub>；所述定位系统坐标系与所述二维图像索引坐标系之间的T<base:Sub>Tracker2Img</base:Sub>变换形成所述第二空间变换T<base:Sub>2</base:Sub>；所述T<base:Sub>Ref2Tracker</base:Sub>变换由所述定位系统实时捕获。</td></tr><tr><td class="content" id="description_45">其中，所述根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术前图像空间与术中物理空间之间的第二空间变换T<base:Sub>2</base:Sub>，包括：</td></tr><tr><td class="content" id="description_46">选定某一时刻，固定所述定位系统、深度相机和相机工具之间的空间位置；</td></tr><tr><td class="content" id="description_47">从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'；</td></tr><tr><td class="content" id="description_48">通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；</td></tr><tr><td class="content" id="description_49">通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_50">由关系式T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>计算所述深度相机坐标系与所述相机工具坐标系之间的T<base:Sub>ToF2Ref</base:Sub>变换；</td></tr><tr><td class="content" id="description_51">由关系式P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>将所述深度相机获取的任一标记点P<base:Sub>ToF</base:Sub>变换至所述定位系统坐标系中，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_52">根据所述关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I及所述第一空间变换T<base:Sub>1</base:Sub>，计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_53">其中，所述根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，包括：</td></tr><tr><td class="content" id="description_54">将所述定位系统获取的所述穿刺工具在所述物理空间中的坐标记为P<base:Sub>T</base:Sub>，将所述穿刺工具在所述术前图像空间中的坐标记为P<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_55">通过关系式P<base:Sub>I</base:Sub>＝T<base:Sub>2</base:Sub>·P<base:Sub>T</base:Sub>将所述穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中。</td></tr><tr><td class="content" id="description_56">一种腹部外科手术导航配准系统，包括：</td></tr><tr><td class="content" id="description_57">第一表面数据提取模块：用于获取手术区域的术前CT图像，并从所述术前CT图像中提取手术区域的术前表面数据；</td></tr><tr><td class="content" id="description_58">第二表面数据提取模块：用于获取手术区域的术中RGB-D图像，并从所述术中RGB-D图像中提取手术区域的术中表面数据；</td></tr><tr><td class="content" id="description_59">配准模块：用于建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，并根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>；</td></tr><tr><td class="content" id="description_60">导航模块：用于根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程。</td></tr><tr><td class="content" id="description_61">其中，所述第一表面数据提取模块还用于：</td></tr><tr><td class="content" id="description_62">采用区域增长算法对所述术前CT图像进行分割处理，提取出所述术前CT图像的腹部区域表面；</td></tr><tr><td class="content" id="description_63">根据所述术前CT图像在人体矢状面方向的索引值对所述腹部区域表面进行分割处理，提取出腹部表面手术区域，并清除所述腹部表面手术区域之外的冗余像素。</td></tr><tr><td class="content" id="description_64">其中，所述第一表面数据提取模块还用于：</td></tr><tr><td class="content" id="description_65">将所述提取出的腹部表面手术区域投影到冠状面方向，生成术前二维投影图像；</td></tr><tr><td class="content" id="description_66">提取所述术前二维投影图像的轮廓，并重构形成术前二维形状图像，进而由所述术前二维形状图像提取所述术前表面数据。</td></tr><tr><td class="content" id="description_67">其中，所述术中RGB-D图像包括RGB图像和深度图像，所述第二表面数据提取模块还用于：</td></tr><tr><td class="content" id="description_68">采用分水岭算法对所述RGB图像进行分割处理，提取出标签图像；</td></tr><tr><td class="content" id="description_69">采用阈值法对所述深度图像进行分割处理，提取出阈值图像；</td></tr><tr><td class="content" id="description_70">将所述阈值图像作为模板与所述标签图像进行与操作，获得初始ROI模板图像；</td></tr><tr><td class="content" id="description_71">将所述初始ROI模板图像作为种子，采用区域增长算法对所述深度图像进行再分割处理，获得最终ROI模板图像。</td></tr><tr><td class="content" id="description_72">其中，所述第二表面数据提取模块还用于对所述最终ROI模板图像进行旋转调整，所述旋转调整包括：</td></tr><tr><td class="content" id="description_73">对所述最终ROI模板图像进行分割处理，提取出ROI轮廓；</td></tr><tr><td class="content" id="description_74">计算所述ROI轮廓的质心与所述ROI轮廓上每个点的距离，并按升序排列；</td></tr><tr><td class="content" id="description_75">分别对排列两端各3％的距离取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义出一个矩形区域；</td></tr><tr><td class="content" id="description_76">将所述最终ROI模板图像与所述矩形区域进行配准处理，获得调整后的ROI模板图像，并由所述调整后的ROI模版图像生成所述术中表面数据。</td></tr><tr><td class="content" id="description_77">其中，所述由所述调整后的ROI模版图像生成所述术中表面数据，包括：</td></tr><tr><td class="content" id="description_78">以所述最小距离与所述最大距离分别作为术中二维形状图像矩形区域的宽和长，并保持术中二维形状图像的质心位置与所述术前二维形状图像的质心位置一致，得到术中二维形状图像；</td></tr><tr><td class="content" id="description_79">由所述术中二维形状图像提取所述术中表面数据。</td></tr><tr><td class="content" id="description_80">其中，所述配准模块还用于：</td></tr><tr><td class="content" id="description_81">对所述术前二维形状图像和所述术中二维形状图像进行配准处理，以建立所述术前表面数据和所述术中表面数据之间的索引关系；</td></tr><tr><td class="content" id="description_82">根据所述索引关系，搜索所述术前CT图像和所述术中RGB-D图像上的对应点；</td></tr><tr><td class="content" id="description_83">根据所述对应点，采用最小二乘匹配算法计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_84">其中，所述术前图像空间包括二维图像索引坐标系，所述术中物理空间包括定位系统坐标系、深度相机坐标系及相机工具坐标系，所述定位系统坐标系与所述二维图像索引坐标系之间的变换关系记为T<base:Sub>Tracker2Img</base:Sub>变换，所述定位系统坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Tracker2ToF</base:Sub>变换，所述二维图像索引坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Img2ToF</base:Sub>变换，所述深度相机坐标系与所述相机工具坐标系之间的变换关系记为T<base:Sub>ToF2Ref</base:Sub>变换，所述相机工具坐标系与所述定位系统坐标系之间的变换关系记为T<base:Sub>Ref2Tracker</base:Sub>变换。</td></tr><tr><td class="content" id="description_85">其中，所述T<base:Sub>Tracker2Img</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2ToF</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I；所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I，其中，I为单位矩阵。</td></tr><tr><td class="content" id="description_86">其中，所述二维图像索引坐标系与所述深度相机坐标系之间的T<base:Sub>Img2ToF</base:Sub>变换形成所述第一空间变换T<base:Sub>1</base:Sub>；所述定位系统坐标系与所述二维图像索引坐标系之间的T<base:Sub>Tracker2Img</base:Sub>变换形成所述第二空间变换T<base:Sub>2</base:Sub>；所述T<base:Sub>Ref2Tracker</base:Sub>变换由所述定位系统实时捕获。</td></tr><tr><td class="content" id="description_87">其中，在选定某一时刻，并固定所述定位系统、深度相机和相机工具之间的空间位置的条件下，从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'，则所述配准模块还用于：</td></tr><tr><td class="content" id="description_88">通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；</td></tr><tr><td class="content" id="description_89">通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_90">由关系式T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>计算所述深度相机坐标系与所述相机工具坐标系之间的T<base:Sub>ToF2Ref</base:Sub>变换；</td></tr><tr><td class="content" id="description_91">由关系式P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>将所述深度相机获取的任一标记点P<base:Sub>ToF</base:Sub>变换至所述定位系统坐标系中，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_92">根据所述关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I及所述第一空间变换T<base:Sub>1</base:Sub>，计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_93">其中，所述导航模块还用于：</td></tr><tr><td class="content" id="description_94">将所述定位系统获取的所述穿刺工具在所述物理空间中的坐标记为P<base:Sub>T</base:Sub>，将所述穿刺工具在所述术前图像空间中的坐标记为P<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_95">通过关系式P<base:Sub>I</base:Sub>＝T<base:Sub>2</base:Sub>·P<base:Sub>T</base:Sub>将所述穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中。</td></tr><tr><td class="content" id="description_96">所述腹部外科手术导航配准方法可以有效简化手术导航过程，在手术导航的整个过程中无须粘贴外部标记点，从而可以避免标记点选取所带来的操作上的不便以及手动选点的潜在错误会导致配准结果误差过大的问题，实现整个手术导航过程的自动化配准。另外，应用所述腹部外科手术导航配准系统还可缩短手术导航操作的时间，最大化地减少人工干预，增强系统的易用性，提高手术导航精度与手术的安全性，让外科医生精准、快速地完成手术操作。</td></tr><tr><td class="content" id="description_97">附图说明</td></tr><tr><td class="content" id="description_98">为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。</td></tr><tr><td class="content" id="description_99">图1是本发明实施例的腹部外科手术导航配准方法的流程示意图。</td></tr><tr><td class="content" id="description_100">图2是本发明实施例的腹部外科手术导航配准方法的空间变换示意图。</td></tr><tr><td class="content" id="description_101">图3是应用图1所示方法的腹部外科手术导航工作流程示意图。</td></tr><tr><td class="content" id="description_102">图4是本发明实施例的腹部外科手术导航配准系统的结构示意图。</td></tr><tr><td class="content" id="description_103">具体实施方式</td></tr><tr><td class="content" id="description_104">下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。</td></tr><tr><td class="content" id="description_105">请参阅图1，本发明实施例提供一种腹部外科手术导航配准方法，通过在腹部外科手术导航系统中引入深度相机，利用深度相机(如<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614670&amp;blobId=3777160148" width="192"/>深度相机)获取腹部表面手术区域的术中RGB-D图像，得到腹部表面手术区域的深度信息，并重建形成术中表面数据；另一方面，利用计算机断层扫描(Computed Tomography，CT)设备获取腹部表面手术区域的术前CT图像，并从中提取出相应的术前表面数据。将所述术前表面数据与所述术中表面数据做配准，计算得到术前图像空间与术中物理空间之间的空间变换，进而在手术过程中将手术器械(如穿刺工具)在术中物理空间中的坐标变换至术前图像空间坐标系中，并实在计算机屏幕上实时显示图像空间中虚拟手术器械与病人解剖结构之间的相对位置关系，以引导医生进行腹部外科手术，提升手术过程导航的精准度及安全性。</td></tr><tr><td class="content" id="description_106">所述腹部外科手术导航配准方法包括：</td></tr><tr><td class="content" id="description_107">步骤S101：获取手术区域的术前计算机断层扫描(Computed Tomography，CT)图像，并从所述术前CT图像中提取手术区域的术前表面数据；</td></tr><tr><td class="content" id="description_108">步骤S102：获取手术区域的术中RGB-D图像，并从所述术中RGB-D图像中提取手术区域的术中表面数据；</td></tr><tr><td class="content" id="description_109">步骤S103：建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，并根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>；</td></tr><tr><td class="content" id="description_110">步骤S104：根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程。</td></tr><tr><td class="content" id="description_111">其中，所述获取手术区域的术前CT图像之后，还包括：</td></tr><tr><td class="content" id="description_112">在所述术前CT图像上选取穿刺的入口点和目标靶点，所述入口点和目标靶点的连线形成穿刺路径。所述在所述术前CT图像上选取穿刺的入口点和目标靶点，包括：</td></tr><tr><td class="content" id="description_113">通过手动选取所述入口点；</td></tr><tr><td class="content" id="description_114">通过自动分割算法从所述术前CT图像中分割出病变区，并计算所述病变区的质点位置为所述目标靶点。</td></tr><tr><td class="content" id="description_115">其中，所述从所述术前CT图像中提取手术区域的术前表面数据，包括：</td></tr><tr><td class="content" id="description_116">采用区域增长算法对所述术前CT图像进行分割处理，提取出所述术前CT图像的腹部区域表面；</td></tr><tr><td class="content" id="description_117">根据所述术前CT图像在人体矢状面方向的索引值对所述腹部区域表面进行分割处理，提取出腹部表面手术区域，并清除所述腹部表面手术区域之外的冗余像素。其中，所述矢状面为将人体分为左右两部分的面，所述CT图像在人体矢状面方向的索引值定义出所述手术区域。</td></tr><tr><td class="content" id="description_118">其中，所述提取出腹部表面手术区域之后，还包括：</td></tr><tr><td class="content" id="description_119">将所述提取出的腹部表面手术区域投影到冠状面方向，生成术前二维投影图像；其中，所述冠状面为将人体纵切为前后两部分的断面。</td></tr><tr><td class="content" id="description_120">提取所述术前二维投影图像的轮廓，并重构形成术前二维形状图像，进而由所述术前二维形状图像提取所述术前表面数据。其中，所述术前二维图像是指包含术前二维投影图像矩形区域的二维切片图像。</td></tr><tr><td class="content" id="description_121">其中，所述术中RGB-D图像包括RGB图像和深度图像，则所述从所述术中RGB-D图像中提取手术区域的术中表面数据，包括：</td></tr><tr><td class="content" id="description_122">采用分水岭算法对所述RGB图像进行分割处理，提取出标签图像；</td></tr><tr><td class="content" id="description_123">采用阈值法对所述深度图像进行分割处理，提取出阈值图像；</td></tr><tr><td class="content" id="description_124">将所述阈值图像作为模板与所述标签图像进行与操作，获得初始感兴趣区域(Region of Interest，ROI)模板图像；</td></tr><tr><td class="content" id="description_125">将所述初始ROI模板图像作为种子，采用区域增长算法对所述深度图像进行再分割处理，获得最终ROI模板图像。</td></tr><tr><td class="content" id="description_126">具体地，首先采用分水岭算法(本实施例中采用医学图像处理软件包ITK里的类itkMorphologicalWatershedImageFilter)对所述RGB图像做分割，得到标签图像；同时采用阈值的方法(以<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614644&amp;blobId=3777050573" width="192"/>深度相机的坐标原点至腹部表面的距离作为阈值)对所述深度图像做分割，得出阈值图像。然后将所述阈值图像作为模板与从所述RGB图像中分割后得到的标签图像做与操作，获得初始ROI模板图像。该初始ROI模板图像可能会因为分割算法的欠分割等原因而出现空洞的现象。最后再将所述初始ROI模板图像作为种子，以<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614660&amp;blobId=3777147526" width="193"/>深度相机的坐标原点至腹部表面的距离为阈值，采用区域增长算法，对所述深度图像再做分割操作，得出最终ROI模板图像。</td></tr><tr><td class="content" id="description_127">其中，所述获得最终ROI模板图像后，还包括对所述最终ROI模板图像进行旋转调整，所述旋转调整包括：</td></tr><tr><td class="content" id="description_128">对所述最终ROI模板图像进行分割处理，提取出ROI轮廓；</td></tr><tr><td class="content" id="description_129">计算所述ROI轮廓的质心与所述ROI轮廓上每个点的距离，并按升序排列；</td></tr><tr><td class="content" id="description_130">分别对排列两端各3％的距离取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义出一个矩形区域；</td></tr><tr><td class="content" id="description_131">将所述最终ROI模板图像与所述矩形区域进行配准处理，获得调整后的ROI模板图像，并由所述调整后的ROI模版图像生成所述术中表面数据。</td></tr><tr><td class="content" id="description_132">具体地，首先从所述最终ROI模板图像中分割出ROI轮廓；然后计算所述ROI轮廓的质心与ROI轮廓上每个点的距离，并做升序排列，分别对排序后序列两端各3％的距离数据取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义了一个矩形区域；最后将所述ROI模板图像与该矩形区域做配准，求得调整后的ROI模板图像。将调整后的ROI模板图像变换至三维坐标系时，所述<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614677&amp;blobId=3777145881" width="192"/>深度相机所获取的所述深度图像的噪声可以采用双边滤波器(本实施例中，采用ITK里的类itkBilateralImageFilter)进行滤波处理。</td></tr><tr><td class="content" id="description_133">其中，所述由所述调整后的ROI模版图像生成所述术中表面数据，包括：</td></tr><tr><td class="content" id="description_134">以由所述ROI轮廓生成的所述最小距离与所述最大距离分别作为术中二维形状图像矩形区域的宽和长，并保持质心位置与所述术前二维形状图像的质心位置一致，得到术中二维形状图像，进而由所述术中二维形状图像提取所述术中表面数据。其中，所述术中二维形状图像与所述术前二维形状图像的像素间隔相同。</td></tr><tr><td class="content" id="description_135">其中，所述建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，包括：</td></tr><tr><td class="content" id="description_136">对所述术前二维形状图像和所述术中二维形状图像进行配准处理，以建立所述术前表面数据和所述术中表面数据之间的索引关系；</td></tr><tr><td class="content" id="description_137">根据所述索引关系，搜索所述术前CT图像和所述术中RGB-D图像上的对应点；</td></tr><tr><td class="content" id="description_138">根据所述对应点，采用最小二乘匹配算法计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_139">具体地，要搜索所述术前CT图像和所述术中RGB-D图像的对应点，需要先将所述术前二维形状图像和所述术中二维形状图像做配准，在本实施例中，采用ITK里的类itkScaleTransform来计算所述术前二维形状图像和所述术中二维形状图像之间的空间变换，建立术前CT图像与术中RGB-D图像间的矩形区域的图像索引对应关系，即所述术前表面数据和所述术中表面数据之间的索引关系。由于三维坐标系与二维图像索引坐标系之间的对应关系已经建立，所以可以将这个对应关系映射到三维坐标系中，求得术前CT图像与术中RGB-D图像(即<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614628&amp;blobId=3776987094" width="192"/>深度相机坐标系)之间的第一空间变换T<base:Sub>1</base:Sub>。在本实施例中，采用最小二乘匹配算法(如ITK里的类itkLandmarkBasedTransformInitializer或者VTK里的类vtkIterativeClosestPointTransform)计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_140">请参阅图2，所述腹部外科手术导航系统包括定位系统、深度相机、相机工具及术前图像，它们间的空间变换如图2所示。其中，所述定位系统为光学或电磁定位系统，其用于实时捕获手术器械在物理空间的位置信息；所述深度相机为<img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614638&amp;blobId=3777113403" width="198"/>深度相机，其用于获取所述术中RGB-D图像；所述相机工具为固定于所述深度相机上的参考帧，所述相机工具可被所述定位系统识别，从而通过所述定位系统即可获取所述相机工具在物理空间的位置信息；所述术前图像为通过计算机断层扫描设备获取的腹部表面手术区域的术前CT图像。</td></tr><tr><td class="content" id="description_141">所述术前图像空间包括二维图像索引坐标系，所述术中物理空间包括定位系统坐标系、深度相机坐标系及相机工具坐标系，所述定位系统坐标系与所述二维图像索引坐标系之间的变换关系记为T<base:Sub>Tracker2Img</base:Sub>变换，所述定位系统坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Tracker2ToF</base:Sub>变换，所述二维图像索引坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Img2ToF</base:Sub>变换，所述深度相机坐标系与所述相机工具坐标系之间的变换关系记为T<base:Sub>ToF2Ref</base:Sub>变换，所述相机工具坐标系与所述定位系统坐标系之间的变换关系记为T<base:Sub>Ref2Tracker</base:Sub>变换。</td></tr><tr><td class="content" id="description_142">其中，所述T<base:Sub>Tracker2Img</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2ToF</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I；所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I，其中，I为单位矩阵。所述二维图像索引坐标系与所述深度相机坐标系之间的T<base:Sub>Img2ToF</base:Sub>变换形成所述第一空间变换T<base:Sub>1</base:Sub>；所述定位系统坐标系与所述二维图像索引坐标系之间的T<base:Sub>Tracker2Img</base:Sub>变换形成所述第二空间变换T<base:Sub>2</base:Sub>；所述T<base:Sub>Ref2Tracker</base:Sub>变换由所述定位系统实时捕获。</td></tr><tr><td class="content" id="description_143">其中，所述根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术前图像空间与术中物理空间之间的第二空间变换T<base:Sub>2</base:Sub>，包括：</td></tr><tr><td class="content" id="description_144">选定某一时刻，固定所述定位系统、深度相机和相机工具之间的空间位置；</td></tr><tr><td class="content" id="description_145">从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'；</td></tr><tr><td class="content" id="description_146">通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；</td></tr><tr><td class="content" id="description_147">通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_148">由关系式T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>计算所述深度相机坐标系与所述相机工具坐标系之间的T<base:Sub>ToF2Ref</base:Sub>变换；</td></tr><tr><td class="content" id="description_149">由关系式P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>将所述深度相机获取的任一标记点P<base:Sub>ToF</base:Sub>变换至所述定位系统坐标系中，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_150">根据所述关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I及所述第一空间变换T<base:Sub>1</base:Sub>，计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_151">具体地，手术导航配准的最终目的是要计算图2中的T<base:Sub>Tracker2Img</base:Sub>变换，即术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>。由于T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2Img</base:Sub>变换三者刚好构成一个闭环结构，因此，只要求得T<base:Sub>Tracker2ToF</base:Sub>变换和T<base:Sub>Img2ToF</base:Sub>变换即可得出T<base:Sub>Tracker2Img</base:Sub>变换，而由对应点搜索的内容可以求得变换T<base:Sub>Img2ToF</base:Sub>，因此问题就转化为求T<base:Sub>Tracker2ToF</base:Sub>变换。</td></tr><tr><td class="content" id="description_152">进一步地，所述T<base:Sub>Tracker2ToF</base:Sub>变换可以通过如下的方法得到：首先在深度相机上固定一个相机工具，如参考帧工具，该参考帧工具是可被定位系统识别的，其空间位置信息可通过所述定位系统实时捕获，即图2中的T<base:Sub>Ref2Tracker</base:Sub>变换已知。因此，需要确定的是定位系统坐标系与深度相机坐标系间的T<base:Sub>Tracker2ToF</base:Sub>变换，而一旦定位系统与深度相机之间的空间位置确定以后，T<base:Sub>Tracker2ToF</base:Sub>变换的值就是固定的。但是如果深度相机与定位系统间的相对位置发生变化时，则T<base:Sub>Tracker2ToF</base:Sub>变换的值也随之改变，而外科手术导航过程中，要保证定位系统与深度相机之间的位置不变，几乎是不可能的事情，难免需要调整两者间的相对位置，以获取最佳的术中导航数据。</td></tr><tr><td class="content" id="description_153">进一步地，考虑图2中的T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换和T<base:Sub>ToF2Ref</base:Sub>变换，这三个变换刚好组成了一个闭环结构，因此可以用T<base:Sub>Ref2Tracker</base:Sub>变换与T<base:Sub>ToF2Ref</base:Sub>变换的乘积来代替T<base:Sub>Tracker2ToF</base:Sub>变换，从而把标记点从深度相机坐标系变换到定位系统坐标系中。即：</td></tr><tr><td class="content" id="description_154">T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>  (1)</td></tr><tr><td class="content" id="description_155">上式中的T<base:Sub>Ref2Tracker</base:Sub>变换可以通过定位系统实时获取，因此定位系统与深度相机之间的相对位置发生变化时，该值也能反映出来；T<base:Sub>ToF2Ref</base:Sub>变换表示深度相机坐标系与参考帧坐标系之间空间变换，在实际操作中，保证深度相机与参考帧之间的相对位置固定不变，而这是很容易做到的，只要把参考帧固定在深度相机上即可，因此T<base:Sub>ToF2Ref</base:Sub>变换的值只要计算一次即可。</td></tr><tr><td class="content" id="description_156">进一步地，由于所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I。所述T<base:Sub>ToF2Ref</base:Sub>变换可以通过如下的方法得到：在某一时刻，固定所述定位系统、深度相机和相机工具之间的空间位置；从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'；通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；然后通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；把T<base:Sub>Tracker2ToF</base:Sub>变换代入(1)式中，可以求出T<base:Sub>ToF2Ref</base:Sub>变换为：T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>。</td></tr><tr><td class="content" id="description_157">由于深度相机与参考帧工具之间的位置是保持不变的，因此，在任一时刻里计算所得的T<base:Sub>ToF2Ref</base:Sub>变换是保持不变的。因此，在任一时刻下，通过深度相机所获取的深度相机坐标系中任一标记点的坐标P<base:Sub>ToF</base:Sub>，可由如下公式变换至所述定位系统坐标系中：P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换T<base:Sub>Tracker2ToF</base:Sub>＝T<base:Sub>ToF2Ref</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>。</td></tr><tr><td class="content" id="description_158">进一步地，根据所述闭环结构所满足的关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I以及所述第一空间变换T<base:Sub>1</base:Sub>＝T<base:Sub>Img2ToF</base:Sub>，即可计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>＝T<base:Sub>Img2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>ToF2Ref</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>。</td></tr><tr><td class="content" id="description_159">其中，所述根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，包括：</td></tr><tr><td class="content" id="description_160">将所述定位系统获取的所述穿刺工具在所述物理空间中的坐标记为P<base:Sub>T</base:Sub>，将所述穿刺工具在所述术前图像空间中的坐标记为P<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_161">通过关系式P<base:Sub>I</base:Sub>＝T<base:Sub>2</base:Sub>·P<base:Sub>T</base:Sub>将所述穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程。</td></tr><tr><td class="content" id="description_162">在本实施例中，通过对所述腹部外科手术导航配准方法进行人体模型穿刺实验验证，实验结果误差如表1所示。</td></tr><tr><td class="content" id="description_163">其中，TPE为目标定位误差，TRE为目标配准误差，UE为用户误差，SRE为表面配准误差；Mean为误差均值，SD为误差标准差，Median为误差中位数，Min为误差最小值，Max为误差最大值。</td></tr><tr><td class="content" id="description_164">表1 人体模型穿刺实验结果误差</td></tr><tr><td class="content" id="description_165"><img src="/sipopublicsearch/servlet/rm/DownLoadServlet?rid=4570614654&amp;blobId=3776940793" width="492"/></td></tr><tr><td class="content" id="description_166">实验结果表明，所述腹部外科手术导航配准方法在引入深度相机以后可避免手工干预标记点选取时的潜在错误，缩短外科手术配准所用的时间，简化导航手术操作流程，且导航配准过程具有可重复性。</td></tr><tr><td class="content" id="description_167">请参阅图3，图3所示为应用所述腹部外科手术导航配准方法的腹部外科手术导航工作流程示意图。所述的腹部外科手术导航工作流程包括：</td></tr><tr><td class="content" id="description_168">步骤S301：术前计划；</td></tr><tr><td class="content" id="description_169">步骤S302：配准；</td></tr><tr><td class="content" id="description_170">步骤S303：跟踪；</td></tr><tr><td class="content" id="description_171">步骤S304：导航。</td></tr><tr><td class="content" id="description_172">其中，所述术前计划步骤进一步包括子步骤术前CT图像扫描、肿瘤分割及穿刺路径规划。具体地，所述术前CT图像扫描用于获取手术区域的术前CT图像，所述肿瘤分割用于从所述术前CT图像中分割出肿瘤区域，所述穿刺路径规划包括在所述术前CT图像上选取穿刺的入口点和目标靶点，所述入口点和目标靶点的连线形成穿刺路径。其中，通过自动分割算法从所述术前CT图像中分割出肿瘤区域，所述入口点通过手动选取，所述目标靶点为所述肿瘤区域的质点。</td></tr><tr><td class="content" id="description_173">其中，所述配准步骤进一步包括子步骤术前表面数据提取、术中表面数据提取及配准空间变换计算。具体地，所述术前表面数据提取用于获取手术区域的术前表面数据，所述术中表面数据提取用于获取手术区域的术中表面数据，所述配准空间变换计算过程即为本发明所述腹部外科手术导航配准方法中计算所述第二空间变换T<base:Sub>2</base:Sub>的过程，此处不再赘述。</td></tr><tr><td class="content" id="description_174">其中，所述跟踪步骤进一步包括子步骤穿刺工具校准及穿刺工具实时跟踪。具体地，所述穿刺工具校准用于将穿刺工具上的定位跟踪工具的坐标转移到所述穿刺工具的针尖，从而在手术导航过程中可通过所述定位系统直接读取所述穿刺工具的针尖在定位系统坐标系中的坐标值，以实现所述穿刺工具的实时跟踪。</td></tr><tr><td class="content" id="description_175">其中，所述导航步骤进一步包括子步骤入口点定位、穿刺工具方向调整及穿刺。具体地，在导航开始前，首先将所述穿刺工具定位至腹部表面的穿刺入口点处，并调整穿刺工具的针体方向，使得穿刺工具的针体方向与穿刺路径的方向一致，然后开始穿刺及导航过程。</td></tr><tr><td class="content" id="description_176">请参阅图4，本发明实施例还提供一种腹部外科手术导航配准系统400，包括：</td></tr><tr><td class="content" id="description_177">第一表面数据提取模块401：用于获取手术区域的术前CT图像，并从所述术前CT图像中提取手术区域的术前表面数据；</td></tr><tr><td class="content" id="description_178">第二表面数据提取模块403：用于获取手术区域的术中RGB-D图像，并从所述术中RGB-D图像中提取手术区域的术中表面数据；</td></tr><tr><td class="content" id="description_179">配准模块405：用于建立所述术前表面数据和所述术中表面数据之间的索引关系，并根据所述索引关系，计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>，并根据所述第一空间变换T<base:Sub>1</base:Sub>，计算术中物理空间与术前图像空间之间的第二空间变换T<base:Sub>2</base:Sub>；</td></tr><tr><td class="content" id="description_180">导航模块407：用于根据所述第二空间变换T<base:Sub>2</base:Sub>，将穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中，开始导航过程。</td></tr><tr><td class="content" id="description_181">其中，所述第一表面数据提取模块401还用于：</td></tr><tr><td class="content" id="description_182">采用区域增长算法对所述术前CT图像进行分割处理，提取出所述术前CT图像的腹部区域表面；</td></tr><tr><td class="content" id="description_183">根据所述术前CT图像在人体矢状面方向的索引值对所述腹部区域表面进行分割处理，提取出腹部表面手术区域，并清除所述腹部表面手术区域之外的冗余像素。其中，所述矢状面为将人体分为左右两部分的面，所述CT图像在人体矢状面方向的索引值定义出所述手术区域。</td></tr><tr><td class="content" id="description_184">其中，所述第一表面数据提取模块401还用于：</td></tr><tr><td class="content" id="description_185">将所述提取出的腹部表面手术区域投影到冠状面方向，生成术前二维投影图像；其中，所述冠状面为将人体纵切为前后两部分的断面。</td></tr><tr><td class="content" id="description_186">提取所述术前二维投影图像的轮廓，并重构形成术前二维形状图像，进由所述术前二维形状图像提取所述术前表面数据。其中，所述术前二维图像是指包含术前二维投影图像矩形区域的二维切片图像。</td></tr><tr><td class="content" id="description_187">其中，所述术中RGB-D图像包括RGB图像和深度图像，所述第二表面数据提取模块403还用于：</td></tr><tr><td class="content" id="description_188">采用分水岭算法对所述RGB图像进行分割处理，提取出标签图像；</td></tr><tr><td class="content" id="description_189">采用阈值法对所述深度图像进行分割处理，提取出阈值图像；</td></tr><tr><td class="content" id="description_190">将所述阈值图像作为模板与所述标签图像进行与操作，获得初始ROI模板图像；</td></tr><tr><td class="content" id="description_191">将所述初始ROI模板图像作为种子，采用区域增长算法对所述深度图像进行再分割处理，获得最终ROI模板图像。</td></tr><tr><td class="content" id="description_192">其中，所述第二表面数据提取模块403还用于对所述最终ROI模板图像进行旋转调整，所述旋转调整包括：</td></tr><tr><td class="content" id="description_193">对所述最终ROI模板图像进行分割处理，提取出ROI轮廓；</td></tr><tr><td class="content" id="description_194">计算所述ROI轮廓的质心与所述ROI轮廓上每个点的距离，并按升序排列；</td></tr><tr><td class="content" id="description_195">分别对排列两端各3％的距离取平均值，并分别标记为最小距离和最大距离，所述最小距离、最大距离及所述质心共同定义出一个矩形区域；</td></tr><tr><td class="content" id="description_196">将所述最终ROI模板图像与所述矩形区域进行配准处理，获得调整后的ROI模板图像，并由所述调整后的ROI模版图像生成所述术中表面数据。</td></tr><tr><td class="content" id="description_197">其中，所述由所述调整后的ROI模版图像生成所述术中表面数据，包括：</td></tr><tr><td class="content" id="description_198">以由所述ROI轮廓生成的所述最小距离与所述最大距离分别作为术中二维形状图像矩形区域的宽和长，并保持质心位置与所述术前二维形状图像的质心位置一致，得到术中二维形状图像，进而由所述术中二维形状图像提取所述术中表面数据。其中，所述术中二维形状图像与所述术前二维形状图像的像素间隔相同。</td></tr><tr><td class="content" id="description_199">其中，所述配准模块405还用于：</td></tr><tr><td class="content" id="description_200">对所述术前二维形状图像和所述术中二维形状图像进行配准处理，以建立所述术前表面数据和所述术中表面数据之间的索引关系；</td></tr><tr><td class="content" id="description_201">根据所述索引关系，搜索所述术前CT图像和所述术中RGB-D图像上的对应点；</td></tr><tr><td class="content" id="description_202">根据所述对应点，采用最小二乘匹配算法计算所述术前CT图像与所述术中RGB-D图像之间的第一空间变换T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_203">其中，所述术前图像空间包括二维图像索引坐标系，所述术中物理空间包括定位系统坐标系、深度相机坐标系及相机工具坐标系，所述定位系统坐标系与所述二维图像索引坐标系之间的变换关系记为T<base:Sub>Tracker2Img</base:Sub>变换，所述定位系统坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Tracker2ToF</base:Sub>变换，所述二维图像索引坐标系与所述深度相机坐标系之间的变换关系记为T<base:Sub>Img2ToF</base:Sub>变换，所述深度相机坐标系与所述相机工具坐标系之间的变换关系记为T<base:Sub>ToF2Ref</base:Sub>变换，所述相机工具坐标系与所述定位系统坐标系之间的变换关系记为T<base:Sub>Ref2Tracker</base:Sub>变换。</td></tr><tr><td class="content" id="description_204">其中，所述T<base:Sub>Tracker2Img</base:Sub>变换、T<base:Sub>Img2ToF</base:Sub>变换及T<base:Sub>Tracker2ToF</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I；所述T<base:Sub>Tracker2ToF</base:Sub>变换、T<base:Sub>Ref2Tracker</base:Sub>变换及T<base:Sub>ToF2Ref</base:Sub>变换构成闭环结构，并满足关系式：T<base:Sub>ToF2Ref</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub>·T<base:Sub>Ref2Tracker</base:Sub>＝I，其中，I为单位矩阵。</td></tr><tr><td class="content" id="description_205">其中，所述二维图像索引坐标系与所述深度相机坐标系之间的T<base:Sub>Img2ToF</base:Sub>变换形成所述第一空间变换T<base:Sub>1</base:Sub>；所述定位系统坐标系与所述二维图像索引坐标系之间的T<base:Sub>Tracker2Img</base:Sub>变换形成所述第二空间变换T<base:Sub>2</base:Sub>；所述T<base:Sub>Ref2Tracker</base:Sub>变换由所述定位系统实时捕获。</td></tr><tr><td class="content" id="description_206">其中，在选定某一时刻，并固定所述定位系统、深度相机和相机工具之间的空间位置的条件下，从所述定位系统坐标系中选取至少三个标记点，形成第一点集P<base:Sub>Tracker</base:Sub>'，则所述配准模块405还用于：</td></tr><tr><td class="content" id="description_207">通过所述深度相机获取所述第一点集P<base:Sub>Tracker</base:Sub>'在所述深度相机坐标系中的坐标，形成的第二点集P<base:Sub>ToF</base:Sub>'；</td></tr><tr><td class="content" id="description_208">通过最小二乘法计算在所述选定时刻下的所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_209">由关系式T<base:Sub>ToF2Ref</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>计算所述深度相机坐标系与所述相机工具坐标系之间的T<base:Sub>ToF2Ref</base:Sub>变换；</td></tr><tr><td class="content" id="description_210">由关系式P<base:Sub>Tracker</base:Sub>＝T<base:Sub>Ref2Tracker</base:Sub>·T<base:Sub>ToF2Ref</base:Sub>·P<base:Sub>ToF</base:Sub>将所述深度相机获取的任一标记点P<base:Sub>ToF</base:Sub>变换至所述定位系统坐标系中，从而获得所述定位系统坐标系与所述深度相机坐标系之间的T<base:Sub>Tracker2ToF</base:Sub>变换；</td></tr><tr><td class="content" id="description_211">根据所述关系式T<base:Sub>Img2ToF</base:Sub>·T<base:Sub>Tracker2Img</base:Sub>·T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>＝I及所述第一空间变换T<base:Sub>1</base:Sub>，计算所述第二空间变换T<base:Sub>2</base:Sub>为：T<base:Sub>2</base:Sub>＝T<base:Sub>Tracker2Img</base:Sub>＝T<base:Sub>Tracker2ToF</base:Sub><base:Sup>-1</base:Sup>·T<base:Sub>1</base:Sub>。</td></tr><tr><td class="content" id="description_212">其中，所述导航模块407还用于：</td></tr><tr><td class="content" id="description_213">将所述定位系统获取的所述穿刺工具在所述物理空间中的坐标记为P<base:Sub>T</base:Sub>，将所述穿刺工具在所述术前图像空间中的坐标记为P<base:Sub>I</base:Sub>；</td></tr><tr><td class="content" id="description_214">通过关系式P<base:Sub>I</base:Sub>＝T<base:Sub>2</base:Sub>·P<base:Sub>T</base:Sub>将所述穿刺工具在所述术中物理空间中的坐标变换至所述术前图像空间之中。</td></tr><tr><td class="content" id="description_215">可以理解，所述腹部外科手术导航配准系统400各模块的功能可参照图1所示方法实施例中相应的表述，在此不再赘述。</td></tr><tr><td class="content" id="description_216">所述腹部外科手术导航配准方法通过深度相机的应用，可以有效简化手术导航过程，在手术导航的整个过程中无须粘贴外部标记点，从而可以避免标记点选取所带来的操作上的不便以及手动选点的潜在错误会导致配准结果误差过大的问题，实现整个手术导航过程的自动化配准。另外，应用本发明方法还可缩短手术导航操作的时间，最大化地减少人工干预，增强手术导航系统的易用性，提高手术导航精度与手术的安全性，让外科医生精准、快速地完成手术操作。</td></tr><tr><td class="content" id="description_217">以上所揭露的仅为本发明的较佳实施例而已，当然不能以此来限定本发明之权利范围，本领域普通技术人员可以理解实现上述实施例的全部或部分流程，并依本发明权利要求所作的等同变化，仍属于发明所涵盖的范围。</td></tr></table></div></body></html>